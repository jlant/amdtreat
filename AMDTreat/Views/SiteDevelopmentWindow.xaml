<Controls:MetroWindow 
    x:Class="AMDTreat.Views.SiteDevelopmentWindow"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
    xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
    xmlns:Controls="clr-namespace:MahApps.Metro.Controls;assembly=MahApps.Metro"
    xmlns:iconPacks="http://metro.mahapps.com/winfx/xaml/iconpacks"
    xmlns:local="clr-namespace:AMDTreat.Views"
    xmlns:models="clr-namespace:AMDTreat.Models"
    xmlns:converters="clr-namespace:AMDTreat.Converters"
    xmlns:Dialog="clr-namespace:MahApps.Metro.Controls.Dialogs;assembly=MahApps.Metro"
    Dialog:DialogParticipation.Register="{Binding}"
    mc:Ignorable="d"
    WindowStartupLocation="CenterScreen"
    ResizeMode="CanResizeWithGrip"
    Title="" 
    TextOptions.TextFormattingMode="Display"
    Width="{Binding Source={x:Static SystemParameters.PrimaryScreenWidth}, Converter={converters:ScreenResolutionRatioConverter}, ConverterParameter='0.9' }"
    Height="{Binding Source={x:Static SystemParameters.PrimaryScreenHeight}, Converter={converters:ScreenResolutionRatioConverter}, ConverterParameter='0.9' }"
    MinWidth="1024"
    MinHeight="768"
    BorderBrush="{DynamicResource AccentColorBrush}"
    BorderThickness="1">

    <Controls:MetroWindow.Resources>
        <ResourceDictionary>
            <ResourceDictionary.MergedDictionaries>
                <ResourceDictionary Source="/AMDTreat;component/Styles/TreatmentModuleGeneralStyles.xaml" />
                <ResourceDictionary Source="/AMDTreat;component/Styles/SiteDevelopmentStyles.xaml" />
            </ResourceDictionary.MergedDictionaries>

            <converters:BoolToBrushBackground x:Key="BoolToBrushBackground" />
            <converters:BoolToBrushBorder x:Key="BoolToBrushBorder" />
            <converters:BoolToBrushSeparater x:Key="BoolToBrushSeparater" />
            <converters:BoolToBrushIcon x:Key="BoolToBrushIcon" />
            <converters:BoolToBrushText x:Key="BoolToBrushText" />
            <converters:BoolToExpanded x:Key="BoolToExpanded" />
            <converters:BoolToVisibility x:Key="BoolToVisibility" />
            <converters:BoolToBrushDataGridForeground x:Key="BoolToBrushDataGridForeground" />

        </ResourceDictionary>
    </Controls:MetroWindow.Resources>

    <Controls:MetroWindow.RightWindowCommands>
        <Controls:WindowCommands>
            <!--<Button ToolTip="Open XML" Content="{iconPacks:Modern PageXml, Width=22, Height=22}" Command="{Binding OpenCommand}" />
            <Button ToolTip="Save XML" Content="{iconPacks:Modern Save, Width=22, Height=22}" Command="{Binding SaveCommand}" />
            <Button ToolTip="Create Report" Content="{iconPacks:Modern PageFilePdf, Width=22, Height=22}" Command="{Binding ShowMessageDialogCommandTbd}" />-->
        </Controls:WindowCommands>
    </Controls:MetroWindow.RightWindowCommands>

    <Controls:MetroWindow.LeftWindowCommands>
        <Controls:WindowCommands>
            <ToggleButton ToolTip="Module Information" IsChecked="{Binding ElementName=flyoutModuleInformation, Path=IsOpen}">
                <StackPanel Orientation="Horizontal">
                    <iconPacks:PackIconModern Kind="BoxLayered" Width="22" Height="22" VerticalAlignment="Center" HorizontalAlignment="Center" />
                    <TextBlock Style="{StaticResource MyTextBlockHeaderSmall}" Text="{Binding Path=ModuleType}" Margin="5,0,0,0" />
                    <TextBlock Style="{StaticResource MyTextBlockHeaderSmall}" Text="{Binding Path=ModuleName, StringFormat={} {0:S}}" Margin="5,0,0,0" FontWeight="Bold" FontStyle="Italic" />
                </StackPanel>
            </ToggleButton>
            <!--<ToggleButton ToolTip="Water Quality Information" IsChecked="{Binding ElementName=flyoutWaterQuality, Path=IsOpen}">
                <StackPanel Orientation="Horizontal">
                    <iconPacks:PackIconModern Kind="WaterDropletAlert" Width="24" Height="22" VerticalAlignment="Center" HorizontalAlignment="Center" />
                    <TextBlock Style="{StaticResource MyTextBlockHeaderSmall}" Text="Water Quality" Margin="5,0,0,0" />
                </StackPanel>
            </ToggleButton>

            <ToggleButton ToolTip="Error Information" IsChecked="{Binding ElementName=flyoutErrorInformation, Path=IsOpen}" >
                <StackPanel Orientation="Horizontal">
                    <iconPacks:PackIconModern Kind="WarningCircle" Width="24" Height="22" VerticalAlignment="Center" HorizontalAlignment="Center" Foreground="{Binding IsError, Converter={StaticResource BoolToBrushIcon}}" />
                    <TextBlock Style="{StaticResource MyTextBlockHeaderSmall}" Text="Errors" Margin="5,0,0,0" />
                </StackPanel>
            </ToggleButton>-->
            
            <Button ToolTip="Sync with Main User Interface" Command="{Binding SyncCommand}">
                <StackPanel Orientation="Horizontal">
                    <iconPacks:PackIconMaterial Kind="Sync" Width="24" Height="22" VerticalAlignment="Center" HorizontalAlignment="Center" />
                    <TextBlock Style="{StaticResource MyTextBlockHeaderSmall}" Text="Sync" Margin="5,0,0,0" />
                </StackPanel>
            </Button>
        </Controls:WindowCommands>
    </Controls:MetroWindow.LeftWindowCommands>

    <Controls:MetroWindow.Flyouts>
        <Controls:FlyoutsControl>
            <Controls:Flyout x:Name="flyoutModuleInformation" Header="Module Information" Position="Left" Width="350" IsOpen="False" Theme="Dark">
                <StackPanel Orientation="Vertical">

                    <Button Style="{StaticResource MyButtonModuleInformation}" ToolTip="Open Module" Command="{Binding OpenCommand}">
                        <StackPanel Orientation="Horizontal">
                            <iconPacks:PackIconModern Kind="PageXml" Style="{StaticResource MyIconPackModernAmdtreatInformationButton}"/>
                            <TextBlock Style="{StaticResource MyTextBlockHeaderSmall}" Text="Open" />
                        </StackPanel>
                    </Button>

                    <Button Style="{StaticResource MyButtonModuleInformation}" ToolTip="Save Module" Command="{Binding SaveCommand}">
                        <StackPanel Orientation="Horizontal">
                            <iconPacks:PackIconModern Kind="Save" Style="{StaticResource MyIconPackModernAmdtreatInformationButton}" />
                            <TextBlock Style="{StaticResource MyTextBlockHeaderSmall}" Text="Save" />
                        </StackPanel>
                    </Button>

                    <Button Style="{StaticResource MyButtonModuleInformation}" ToolTip="Create Module Report" Command="{Binding ShowMessageDialogCommandTbd}">
                        <StackPanel Orientation="Horizontal">
                            <iconPacks:PackIconModern Kind="PagePdf" Style="{StaticResource MyIconPackModernAmdtreatInformationButton}" />
                            <TextBlock Style="{StaticResource MyTextBlockHeaderSmall}" Text="Report" />
                        </StackPanel>
                    </Button>

                    <Button Style="{StaticResource MyButtonModuleInformation}" ToolTip="About Module" Command="{Binding ShowMessageDialogCommandAbout}">
                        <StackPanel Orientation="Horizontal">
                            <iconPacks:PackIconModern Kind="InformationCircle" Style="{StaticResource MyIconPackModernAmdtreatInformationButton}" />
                            <TextBlock Style="{StaticResource MyTextBlockHeaderSmall}" Text="About" />
                        </StackPanel>
                    </Button>

                    <Button Style="{StaticResource MyButtonModuleInformation}" ToolTip="Open Help" Command="{Binding HelpCommand}">
                        <StackPanel Orientation="Horizontal">
                            <iconPacks:PackIconModern Kind="Question" Style="{StaticResource MyIconPackModernAmdtreatInformationButton}" />
                            <TextBlock Style="{StaticResource MyTextBlockHeaderSmall}" Text="Help" />
                        </StackPanel>
                    </Button>

                    <Separator Style="{StaticResource MySeparatorFlyout}" />

                    <TextBlock Style="{StaticResource MyTextBlockHeaderFlyout}" Text="Module Name" />
                    <TextBox Margin="10,2,10,10" TextWrapping="Wrap" Text="{Binding Path=ModuleName, Mode=TwoWay}" KeyUp="TextBox_KeyEnterUpdate" FontSize="14" />
                    <TextBlock Style="{StaticResource MyTextBlockHeaderFlyout}"  Text="Notes" />
                    <RichTextBox Margin="10,2,10,10" Controls:TextBoxHelper.Watermark="Enter your notes" Height="200" FontSize="14" 
                                 SpellCheck.IsEnabled="True" VerticalScrollBarVisibility="Auto" />
                </StackPanel>
            </Controls:Flyout>

            <Controls:Flyout x:Name="flyoutWaterQuality" Header="Input Water Quality" Position="Left" Width="350" IsOpen="False" Theme="Dark">
                <StackPanel Orientation="Vertical">
                    <Grid Margin="10,0,0,0" >
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="0.5*"></ColumnDefinition>
                            <ColumnDefinition></ColumnDefinition>
                        </Grid.ColumnDefinitions>

                        <Grid.RowDefinitions>
                            <RowDefinition></RowDefinition>
                            <RowDefinition></RowDefinition>
                            <RowDefinition></RowDefinition>
                            <RowDefinition></RowDefinition>
                            <RowDefinition></RowDefinition>
                            <RowDefinition></RowDefinition>
                            <RowDefinition></RowDefinition>
                        </Grid.RowDefinitions>

                        <Button Grid.Row="0" Grid.Column="1" Style="{DynamicResource MetroCircleButtonStyle}" ToolTip="About Water Quality" 
                                Content="{iconPacks:Modern InformationCircle, Width=20, Height=20}"  
                                Command="{Binding ShowMessageDialogCommandWaterQuality}" 
                                Opacity="0.6" BorderThickness="1" VerticalAlignment="Top" HorizontalAlignment="Right" Margin="10,5" />


                    </Grid>
                </StackPanel>
            </Controls:Flyout>

            <Controls:Flyout x:Name="flyoutErrorInformation" Header="Error Information" Position="Left" Width="350" IsOpen="{Binding IsOpenFlyoutError}" Theme="Dark">
                <StackPanel Orientation="Vertical">
                    <Grid Margin="10,0,0,0" >
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition></ColumnDefinition>
                        </Grid.ColumnDefinitions>

                        <Grid.RowDefinitions>
                            <RowDefinition></RowDefinition>
                            <RowDefinition></RowDefinition>
                            <RowDefinition></RowDefinition>
                            <RowDefinition></RowDefinition>
                            <RowDefinition></RowDefinition>
                        </Grid.RowDefinitions>

                        <TextBlock Grid.Row="0" Grid.Column="0" Style="{StaticResource MyTextBlockPropertyName}" Text="Maximum Pond Depth" />
                        <StackPanel Grid.Row="0" Grid.Column="1" Style="{StaticResource MyStackPanel}" >
                            <TextBlock Style="{StaticResource MyTextBlockPropertyValue}" Text="{Binding CalcMaxPondDepth, Mode=Twoway, StringFormat=F2}" />
                            <TextBlock  Style="{StaticResource MyTextBlockPropertyUnits}" Text="ft" />
                        </StackPanel>

                        <TextBlock Grid.Row="1" Grid.Column="0" Style="{StaticResource MyTextBlockPropertyName}" Text="Current Pond Depth" />
                        <StackPanel Grid.Row="1" Grid.Column="1" Style="{StaticResource MyStackPanel}" >
                            <TextBlock Style="{StaticResource MyTextBlockPropertyValue}" Text="{Binding CalcPondDepth, Mode=Twoway, StringFormat=F2}" />
                            <TextBlock  Style="{StaticResource MyTextBlockPropertyUnits}" Text="ft" />
                        </StackPanel>

                        <Separator Grid.Row="2" Style="{StaticResource MySeparatorFlyout}" />
                        <TextBlock Grid.Row="3" Grid.ColumnSpan="2" Style="{StaticResource MyTextBlockHeader}" Text="{Binding ErrorMessageShort}" TextWrapping="Wrap"/>
                        <TextBlock Name="ErrorMessageTextBlock" Grid.Row="4" Grid.ColumnSpan="2" Style="{StaticResource MyTextBlockPropertyName}" Text="{Binding Path=ErrorMessage, Mode=TwoWay}" TextWrapping="Wrap"/>

                    </Grid>
                </StackPanel>
            </Controls:Flyout>

        </Controls:FlyoutsControl>
    </Controls:MetroWindow.Flyouts>

    <Grid>
        <Grid.ColumnDefinitions>
            <ColumnDefinition></ColumnDefinition>
            <ColumnDefinition></ColumnDefinition>
        </Grid.ColumnDefinitions>

        <Grid.RowDefinitions>
            <RowDefinition></RowDefinition>
        </Grid.RowDefinitions>

        <ScrollViewer Grid.Column="0" MinHeight="700" CanContentScroll="False" Margin="0,-10,0,10">
            <StackPanel Grid.Column="0" Margin="10">

                <!-- Equipment -->
                <Grid Style="{StaticResource MyGridHeader}">
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition ></ColumnDefinition>
                        <ColumnDefinition Width=".1*"></ColumnDefinition>
                    </Grid.ColumnDefinitions>

                    <Grid.RowDefinitions>
                        <RowDefinition></RowDefinition>
                    </Grid.RowDefinitions>

                    <StackPanel Grid.Row="0" Grid.Column="0" Orientation="Horizontal">
                        <iconPacks:PackIconModern Kind="DimensionArrowBoxHeight" Style="{StaticResource MyIconPackModernHeaders}" />
                        <TextBlock Grid.Row="0" Grid.Column="0" Style="{StaticResource MyTextBlockHeader}" Text="Site Development Items" />
                    </StackPanel>
                    <Button Grid.Row="0" Grid.Column="1" Style="{StaticResource MyButtonSectionInformation}" ToolTip="About Site Development Items" 
                                Content="{iconPacks:Modern InformationCircle, Width=12, Height=12}"  
                                Command="{Binding ShowMessageDialogCommandSiteDevelopmentItems}"/>
                    <Separator Grid.Row="0" Grid.ColumnSpan="2" Style="{StaticResource MySeparatorHeader}" Background="{Binding IsError, Converter={StaticResource BoolToBrushSeparater}}" />
                </Grid>

                <!-- Note: added a Margin to the StackPanel to match the ScrollViewer style for each section -->
                <StackPanel Margin="0,0,0,10">

                    <Expander Style="{StaticResource MyExpanderPropertyQuantityCost}">
                        <ScrollViewer CanContentScroll="True" HorizontalScrollBarVisibility="Auto" Height="230">
                            <Grid>
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition></ColumnDefinition>
                                    <ColumnDefinition></ColumnDefinition>
                                </Grid.ColumnDefinitions>

                                <Grid.RowDefinitions>
                                    <RowDefinition></RowDefinition>
                                    <RowDefinition></RowDefinition>
                                    <RowDefinition></RowDefinition>
                                    <RowDefinition></RowDefinition>
                                    <RowDefinition></RowDefinition>
                                    <RowDefinition></RowDefinition>
                                    <RowDefinition></RowDefinition>
                                    <RowDefinition></RowDefinition>
                                    <RowDefinition></RowDefinition>

                                </Grid.RowDefinitions>

                                <Grid.Resources>
                                    <converters:RadioButtonCheckedConverter x:Key="RadioButtonCheckedConverter" />
                                </Grid.Resources>

                                <Label Grid.Row="0" Grid.Column="0" Style="{StaticResource MyLabelPropertyName}" Content="Land Quantity" />

                                <RadioButton x:Name="radioButtonLandQuantityEstimate" Grid.Row="1" Grid.Column="0" Margin="50,0,0,0" FontSize="14" GroupName="LandQuantity" Content="Estimate" 
                                 IsChecked="{Binding LandQuantityOptionsProperty, Mode=TwoWay, Converter={StaticResource RadioButtonCheckedConverter}, ConverterParameter=OptionEstimate}" />

                                <RadioButton x:Name="radioButtonLandQuantityUserSpecified" Grid.Row="2" Grid.Column="0" Margin="50,0,0,0" FontSize="14" GroupName="LandQuantity" Content="User-Specified" 
                                 IsChecked="{Binding LandQuantityOptionsProperty, Mode=TwoWay, Converter={StaticResource RadioButtonCheckedConverter}, ConverterParameter=OptionUserSpecified}"/>

                                <StackPanel Grid.Row="1" Grid.Column="1" Style="{StaticResource MyStackPanel}" >
                                    <Label Style="{StaticResource MyLabelPropertyName}" Content="" />
                                    <Label Style="{StaticResource MyLabelPropertyUnits}" Content="" />
                                </StackPanel>

                                <StackPanel Grid.Row="2" Grid.Column="1" Style="{StaticResource MyStackPanel}" >
                                    <Label Style="{StaticResource MyLabelLandQuantityUserSpecifiedName}" Content="Quantity" />
                                    <Controls:NumericUpDown Style="{StaticResource MyNumericUpDownLandQuantityUserSpecified}" Minimum="0" Maximum="200" Interval="1"
                                                Value="{Binding LandQuantityUserSpecified, Mode=TwoWay}"
                                                ToolTip="min = 0, max = 200"/>
                                    <Label Style="{StaticResource MyLabelLandQuantityUserSpecifiedUnits}" Content="acres" />
                                </StackPanel>

                                <Label Grid.Row="3" Grid.Column="0" Style="{StaticResource MyLabelPropertyName}" Content="Land Cost" />

                                <RadioButton x:Name="radioButtonLandCostPurchase" Grid.Row="4" Grid.Column="0" Margin="50,0,0,0" FontSize="14" GroupName="LandCost" Content="Purchase" 
                                 IsChecked="{Binding LandCostOptionsProperty, Mode=TwoWay, Converter={StaticResource RadioButtonCheckedConverter}, ConverterParameter=OptionPurchase}" />

                                <RadioButton x:Name="radioButtonLandCostLease" Grid.Row="6" Grid.Column="0" Margin="50,0,0,0" FontSize="14" GroupName="LandCost" Content="Lease" 
                                 IsChecked="{Binding LandCostOptionsProperty, Mode=TwoWay, Converter={StaticResource RadioButtonCheckedConverter}, ConverterParameter=OptionLease}"/>

                                <StackPanel Grid.Row="4" Grid.Column="1" Style="{StaticResource MyStackPanel}" >
                                    <Label Style="{StaticResource MyLabelLandPurchaseUnitCostName}" Content="Purchase Unit Cost" />
                                    <Controls:NumericUpDown Style="{StaticResource MyNumericUpDownLandPurchaseUnitCost}" Minimum="0" Maximum="100000" Interval="100" StringFormat="C2" 
                                                Value="{Binding LandPurchaseUnitCost, Mode=TwoWay}"
                                                ToolTip="min = 0, max = 1,000,000"/>
                                    <Label Style="{StaticResource MyLabelLandPurchaseUnitCostUnits}" Content="$/acre" />
                                </StackPanel>

                                <StackPanel Grid.Row="5" Grid.Column="1" Style="{StaticResource MyStackPanel}" >
                                    <Label Style="{StaticResource MyLabelLandPurchaseClosingCostName}" Content="Closing Cost" />
                                    <Controls:NumericUpDown Style="{StaticResource MyNumericUpDownLandPurchaseClosingCost}" Minimum="0" Maximum="100000" Interval="100" StringFormat="C2" 
                                                Value="{Binding LandPurchaseClosingCost, Mode=TwoWay}"
                                                ToolTip="min = 0, max = 1,000,000"/>
                                    <Label Style="{StaticResource MyLabelLandPurchaseClosingCostUnits}" Content="$" />
                                </StackPanel>

                                <StackPanel Grid.Row="6" Grid.Column="1" Style="{StaticResource MyStackPanel}" >
                                    <Label Style="{StaticResource MyLabelLandLeaseCostName}" Content="Annual Lease Unit Cost" />
                                    <Controls:NumericUpDown Style="{StaticResource MyNumericUpDownLandLeaseCost}" Minimum="0" Maximum="100000" Interval="100" StringFormat="C2" 
                                                Value="{Binding LandLeaseCost, Mode=TwoWay}"
                                                ToolTip="min = 0, max = 1,000,000"/>
                                    <Label Style="{StaticResource MyLabelLandLeaseCostUnits}" Content="$/acre/yr" />
                                </StackPanel>
                            </Grid>

                        </ScrollViewer>
                    </Expander>

                    <Expander Style="{StaticResource MyExpanderSiteWork}">
                        <ScrollViewer CanContentScroll="True" HorizontalScrollBarVisibility="Auto" Height="270">
                            <Grid>
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition></ColumnDefinition>
                                    <ColumnDefinition></ColumnDefinition>
                                </Grid.ColumnDefinitions>

                                <Grid.RowDefinitions>
                                    <RowDefinition></RowDefinition>
                                    <RowDefinition></RowDefinition>
                                    <RowDefinition></RowDefinition>
                                    <RowDefinition></RowDefinition>
                                    <RowDefinition></RowDefinition>
                                    <RowDefinition></RowDefinition>
                                    <RowDefinition></RowDefinition>
                                    <RowDefinition></RowDefinition>
                                </Grid.RowDefinitions>

                                <Grid.Resources>
                                    <converters:RadioButtonCheckedConverter x:Key="RadioButtonCheckedConverter" />
                                </Grid.Resources>

                                <Label Grid.Row="0" Grid.Column="0" Style="{StaticResource MyLabelPropertyName}" Content="Mobilization/Demobilization" />
                                <StackPanel Grid.Row="0" Grid.Column="1" Style="{StaticResource MyStackPanel}" >
                                    <Controls:NumericUpDown Style="{StaticResource MyNumericUpDown}" Minimum="0" Maximum="25" Interval="0.5" 
                                                            Value="{Binding MobilizationDemobilizationPercentage, Mode=TwoWay}"
                                                            ToolTip="min = 0, max = 25"/>
                                    <Label Style="{StaticResource MyLabelPropertyUnits}" Content="%" />
                                </StackPanel>

                                <CheckBox x:Name="checkBoxConstructionOfficeTrailer" Grid.Row="1" Grid.Column="0" Margin="5" FontSize="14" Content="Construction Office Trailer"
                                          IsChecked="{Binding IsConstructionOfficeTrailer, Mode=TwoWay}"/>
                                <StackPanel Grid.Row="1" Grid.Column="1" Style="{StaticResource MyStackPanel}" >
                                    <Controls:NumericUpDown Style="{StaticResource MyNumericUpDownConstructionOfficeTrailerCost}" Minimum="0" Maximum="200000" Interval="100" StringFormat="C2" 
                                                            Value="{Binding ConstructionOfficeTrailerCost, Mode=TwoWay}"
                                                            ToolTip="min = 0, max = 200,000"/>
                                    <Label Style="{StaticResource MyLabelConstructionOfficeTrailerCostUnits}" Content="$" />
                                </StackPanel>

                                <Label Grid.Row="2" Grid.Column="0" Style="{StaticResource MyLabelPropertyName}" Content="Average Site Slope" />
                                <StackPanel Grid.Row="2" Grid.Column="1" Style="{StaticResource MyStackPanel}" >
                                    <Controls:NumericUpDown Style="{StaticResource MyNumericUpDown}" Minimum="0" Maximum="50" Interval="1" 
                                                            Value="{Binding AverageSiteSlope, Mode=TwoWay}"
                                                            ToolTip="min = 0, max = 50"/>
                                    <Label Style="{StaticResource MyLabelPropertyUnits}" Content="%" />
                                </StackPanel>

                                <Label Grid.Row="3" Grid.Column="0" Style="{StaticResource MyLabelPropertyName}" Content="Cut/Fill Slope (#H:1V)" />
                                <StackPanel Grid.Row="3" Grid.Column="1" Style="{StaticResource MyStackPanel}" >
                                    <Controls:NumericUpDown Style="{StaticResource MyNumericUpDown}" Minimum="2" Maximum="10" Interval="0.5" 
                                                            Value="{Binding CutFillSlope, Mode=TwoWay}"
                                                            ToolTip="min = 2, max = 10"/>
                                    <Label Style="{StaticResource MyLabelPropertyUnits}" Content="ft" />
                                </StackPanel>

                                <Label Grid.Row="4" Grid.Column="0" Style="{StaticResource MyLabelPropertyName}" Content="Excavation Unit Cost" />
                                <StackPanel Grid.Row="4" Grid.Column="1" Style="{StaticResource MyStackPanel}" >
                                    <Controls:NumericUpDown Style="{StaticResource MyNumericUpDown}" Minimum="0" Maximum="25" Interval="0.5" StringFormat="C2" 
                                                            Value="{Binding ExcavationUnitCost, Mode=TwoWay}"
                                                            ToolTip="min = 0, max = 25"/>
                                    <Label Style="{StaticResource MyLabelPropertyUnits}" >
                                        <Run Typography.Variants="Superscript">$/yd&#x00B3;</Run>
                                    </Label>
                                </StackPanel>

                                <Label Grid.Row="5" Grid.Column="0" Style="{StaticResource MyLabelPropertyName}" Content="Maintenance/Repair Labor Rate" />
                                <StackPanel Grid.Row="5" Grid.Column="1" Style="{StaticResource MyStackPanel}" >
                                    <Controls:NumericUpDown Style="{StaticResource MyNumericUpDown}" Minimum="0" Maximum="100" Interval="1" StringFormat="C2" 
                                                            Value="{Binding MaintenanceRepairLaborRate, Mode=TwoWay}"
                                                            ToolTip="min = 0, max = 100"/>
                                    <Label Style="{StaticResource MyLabelPropertyUnits}" Content="$/hr"/>
                                </StackPanel>

                                <CheckBox x:Name="checkBoxFoundationOverExcavation" Grid.Row="6" Grid.Column="0" Margin="5" FontSize="14" Content="Foundation Overexcavation Unit Cost"
                                          IsChecked="{Binding IsFoundationOverExcavation, Mode=TwoWay}"/>
                                <StackPanel Grid.Row="6" Grid.Column="1" Style="{StaticResource MyStackPanel}" >
                                    <Controls:NumericUpDown Style="{StaticResource MyNumericUpDownFoundationOverExcavationUnitCost}" Minimum="0" Maximum="25" Interval="0.5" StringFormat="C2" 
                                                            Value="{Binding FoundationOverExcavationUnitCost, Mode=TwoWay}"
                                                            ToolTip="min = 0, max = 25"/>
                                    <Label Style="{StaticResource MyLabelFoundationOverExcavationUnitCostUnits}" >
                                        <Run Typography.Variants="Superscript">$/yd&#x00B3;</Run>
                                    </Label>
                                </StackPanel>

                                <Label Grid.Row="7" Grid.Column="0" Style="{StaticResource MyLabelPropertyName}" Content="Foundation Improvement Unit Cost" />
                                <StackPanel Grid.Row="7" Grid.Column="1" Style="{StaticResource MyStackPanel}" >
                                    <Controls:NumericUpDown Style="{StaticResource MyNumericUpDown}" Minimum="0" Maximum="59" Interval="1" StringFormat="C2" 
                                                            Value="{Binding FoundationImprovementUnitCost, Mode=TwoWay}"
                                                            ToolTip="min = 0, max = 59"/>
                                    <Label Style="{StaticResource MyLabelPropertyUnits}" >
                                        <Run Typography.Variants="Superscript">$/yd&#x00B3;</Run>
                                    </Label>
                                </StackPanel>

                            </Grid>

                        </ScrollViewer>
                    </Expander>

                    <Expander Style="{StaticResource MyExpanderAccessRoads}">
                        <ScrollViewer CanContentScroll="True" HorizontalScrollBarVisibility="Auto" Height="330">
                            <Grid>
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition></ColumnDefinition>
                                    <ColumnDefinition></ColumnDefinition>
                                </Grid.ColumnDefinitions>

                                <Grid.RowDefinitions>
                                    <RowDefinition></RowDefinition>
                                    <RowDefinition></RowDefinition>
                                    <RowDefinition></RowDefinition>
                                    <RowDefinition></RowDefinition>
                                    <RowDefinition></RowDefinition>
                                    <RowDefinition></RowDefinition>
                                    <RowDefinition></RowDefinition>
                                    <RowDefinition></RowDefinition>
                                    <RowDefinition></RowDefinition>
                                    <RowDefinition></RowDefinition>
                                    <RowDefinition></RowDefinition>
                                    <RowDefinition></RowDefinition>
                                    <RowDefinition></RowDefinition>
                                    <RowDefinition></RowDefinition>
                                    <RowDefinition></RowDefinition>
                                </Grid.RowDefinitions>

                                <Grid.Resources>
                                    <converters:RadioButtonCheckedConverter x:Key="RadioButtonCheckedConverter" />
                                </Grid.Resources>

                                <CheckBox x:Name="checkBoxAccessRoad" Grid.Row="0" Grid.Column="0" Margin="5" FontSize="14" Content="Access Road"
                                          IsChecked="{Binding IsAccessRoad, Mode=TwoWay}"/>

                                <Label Grid.Row="1" Grid.Column="0" Style="{StaticResource MyLabelPropertyName}" Margin="50,0,0,0" Content="Material Type" />
                                <StackPanel Grid.Row="1" Grid.Column="1" Style="{StaticResource MyStackPanel}" >
                                    <Controls:DropDownButton 
                                        VerticalContentAlignment="Center"
                                        Width="150"
                                        Margin="4"
                                        Content="{Binding RoadMaterialName}"
                                        ItemsSource="{Binding RoadMaterials}"
                                        Style="{StaticResource MyDropDownAccessRoadMaterials}">
                                        <Controls:DropDownButton.Resources>
                                            <models:BindingProxy x:Key="Proxy" Data="{Binding}" />
                                        </Controls:DropDownButton.Resources>
                                        <Controls:DropDownButton.ItemContainerStyle>
                                            <Style TargetType="MenuItem" BasedOn="{StaticResource {x:Type MenuItem}}">
                                                <Setter Property="Header" Value="{Binding Name}"/>
                                                <Setter Property="Command" Value="{Binding Source={StaticResource Proxy}, Path=Data.SetRoadMaterialCommand}"/>
                                                <Setter Property="CommandParameter" Value="{Binding }"/>
                                            </Style>
                                        </Controls:DropDownButton.ItemContainerStyle>
                                    </Controls:DropDownButton>
                                    <Label Style="{StaticResource MyLabelPropertyUnits}" Content="" />
                                </StackPanel>

                                <Label Grid.Row="2" Grid.Column="0" Style="{StaticResource MyLabelPropertyName}"  Margin="50,0,0,0" Content="Aggregate Unit Cost" />
                                <StackPanel Grid.Row="2" Grid.Column="1" Style="{StaticResource MyStackPanel}" >
                                    <Controls:NumericUpDown Style="{StaticResource MyNumericUpDownRoadMaterialUnitCostAggregate}" Minimum="0" Maximum="50" Interval="1" StringFormat="C2" 
                                                            Value="{Binding RoadMaterialUnitCostAggregate, Mode=TwoWay}"
                                                            ToolTip="min = 0, max = 50"/>
                                    <Label Style="{StaticResource MyLabelRoadMaterialUnitCostAggregateUnits}" >
                                        <Run Typography.Variants="Superscript">$/yd&#x00B2;</Run>
                                    </Label>
                                </StackPanel>

                                <Label Grid.Row="3" Grid.Column="0" Style="{StaticResource MyLabelPropertyName}"  Margin="50,0,0,0" Content="Asphalt Unit Cost" />
                                <StackPanel Grid.Row="3" Grid.Column="1" Style="{StaticResource MyStackPanel}" >
                                    <Controls:NumericUpDown Style="{StaticResource MyNumericUpDownRoadMaterialUnitCostAsphalt}" Minimum="0" Maximum="50" Interval="0.5" StringFormat="C2" 
                                                            Value="{Binding RoadMaterialUnitCostAsphalt, Mode=TwoWay}"
                                                            ToolTip="min = 0, max = 50"/>
                                    <Label Style="{StaticResource MyLabelRoadMaterialUnitCostAsphaltUnits}" >
                                        <Run Typography.Variants="Superscript">$/yd&#x00B2;</Run>
                                    </Label>
                                </StackPanel>

                                <Label Grid.Row="4" Grid.Column="0" Style="{StaticResource MyLabelPropertyName}"  Margin="50,0,0,0" Content="Aggregate Subbase Unit Cost" />
                                <StackPanel Grid.Row="4" Grid.Column="1" Style="{StaticResource MyStackPanel}" >
                                    <Controls:NumericUpDown Style="{StaticResource MyNumericUpDownRoadMaterialUnitCostSubbase}" Minimum="0" Maximum="50" Interval="1" StringFormat="C2" 
                                                            Value="{Binding RoadMaterialUnitCostSubbase, Mode=TwoWay}"
                                                            ToolTip="min = 0, max = 50"/>
                                    <Label Style="{StaticResource MyLabelRoadMaterialUnitCostSubbaseUnits}" >
                                        <Run Typography.Variants="Superscript">$/yd&#x00B2;</Run>
                                    </Label>
                                </StackPanel>

                                <Label Grid.Row="5" Grid.Column="0" Style="{StaticResource MyLabelPropertyName}"  Margin="50,0,0,0" Content="Access Road Length" />
                                <StackPanel Grid.Row="5" Grid.Column="1" Style="{StaticResource MyStackPanel}" >
                                    <Controls:NumericUpDown Style="{StaticResource MyNumericUpDownAccessRoadLength}" Minimum="0" Maximum="50000" Interval="5" 
                                                            Value="{Binding AccessRoadLength, Mode=TwoWay}"
                                                            ToolTip="min = 0, max = 50,000"/>
                                    <Label Style="{StaticResource MyLabelAccessRoadLengthUnits}" Content="ft"/>
                                </StackPanel>

                                <Label Grid.Row="6" Grid.Column="0" Style="{StaticResource MyLabelPropertyName}"  Margin="50,0,0,0" Content="Access Road Width" />
                                <StackPanel Grid.Row="6" Grid.Column="1" Style="{StaticResource MyStackPanel}" >
                                    <Controls:NumericUpDown Style="{StaticResource MyNumericUpDownAccessRoadWidth}" Minimum="5" Maximum="50" Interval="1" 
                                                            Value="{Binding AccessRoadWidth, Mode=TwoWay}"
                                                            ToolTip="min = 5, max = 50"/>
                                    <Label Style="{StaticResource MyLabelAccessRoadWidthUnits}" Content="ft"/>
                                </StackPanel>

                                <CheckBox x:Name="checkBoxAccessRoadGeotextileLength" Grid.Row="7" Grid.Column="0" Margin="50,0,0,0" FontSize="14" Content="Access Road Geotextile Length"
                                          IsChecked="{Binding IsAccessRoadGeotextile, Mode=TwoWay}"
                                          IsEnabled="{Binding IsAccessRoad, Mode=TwoWay}"/>
                                <StackPanel Grid.Row="7" Grid.Column="1" Style="{StaticResource MyStackPanel}" >
                                    <Controls:NumericUpDown Style="{StaticResource MyNumericUpDownAccessRoadGeotextileLength}" Minimum="0" Maximum="50000" Interval="5" 
                                                            Value="{Binding AccessRoadGeotextileLength, Mode=TwoWay}"
                                                            ToolTip="min = 0, max = 50,000"/>
                                    <Label Style="{StaticResource MyLabelAccessRoadGeotextileLengthUnits}" Content="ft"/>
                                </StackPanel>

                                <CheckBox x:Name="checkBoxParkingArea" Grid.Row="8" Grid.Column="0" Margin="5" FontSize="14" Content="Parking Area"
                                          IsChecked="{Binding IsParkingArea, Mode=TwoWay}"/>

                                <Label Grid.Row="9" Grid.Column="0" Style="{StaticResource MyLabelPropertyName}" Margin="50,0,0,0" Content="Material Type" />
                                <StackPanel Grid.Row="9" Grid.Column="1" Style="{StaticResource MyStackPanel}" >
                                    <Controls:DropDownButton 
                                        VerticalContentAlignment="Center"
                                        Width="150"
                                        Margin="4"
                                        Content="{Binding ParkingAreaMaterialName}"
                                        ItemsSource="{Binding ParkingAreaMaterials}"
                                        Style="{StaticResource MyDropDownParkingAreaMaterials}">
                                        <Controls:DropDownButton.Resources>
                                            <models:BindingProxy x:Key="Proxy" Data="{Binding}" />
                                        </Controls:DropDownButton.Resources>
                                        <Controls:DropDownButton.ItemContainerStyle>
                                            <Style TargetType="MenuItem" BasedOn="{StaticResource {x:Type MenuItem}}">
                                                <Setter Property="Header" Value="{Binding Name}"/>
                                                <Setter Property="Command" Value="{Binding Source={StaticResource Proxy}, Path=Data.SetParkingAreaMaterialCommand}"/>
                                                <Setter Property="CommandParameter" Value="{Binding }"/>
                                            </Style>
                                        </Controls:DropDownButton.ItemContainerStyle>
                                    </Controls:DropDownButton>
                                    <Label Style="{StaticResource MyLabelPropertyUnits}" Content="" />
                                </StackPanel>

                                <Label Grid.Row="10" Grid.Column="0" Style="{StaticResource MyLabelPropertyName}"  Margin="50,0,0,0" Content="Number of Parking Spaces" />
                                <StackPanel Grid.Row="10" Grid.Column="1" Style="{StaticResource MyStackPanel}" >
                                    <Controls:NumericUpDown Style="{StaticResource MyNumericUpDownParkingSpacesQuantity}" Minimum="0" Maximum="50" Interval="1" 
                                                            Value="{Binding ParkingSpacesQuantity, Mode=TwoWay}"
                                                            ToolTip="min = 0, max = 50"/>
                                    <Label Style="{StaticResource MyLabelParkingSpacesQuantityUnits}" Content=""/>
                                </StackPanel>

                                <Label Grid.Row="11" Grid.Column="0" Style="{StaticResource MyLabelPropertyName}"  Margin="50,0,0,0" Content="Average Parking Space Area" />
                                <StackPanel Grid.Row="11" Grid.Column="1" Style="{StaticResource MyStackPanel}" >
                                    <Controls:NumericUpDown Style="{StaticResource MyNumericUpDownAverageParkingSpaceArea}" Minimum="0" Maximum="500" Interval="5" 
                                                            Value="{Binding AverageParkingSpaceArea, Mode=TwoWay}"
                                                            ToolTip="min = 0, max = 500"/>
                                    <Label Style="{StaticResource MyLabelAverageParkingSpaceAreaUnits}" >
                                        <Run Typography.Variants="Superscript">ft&#x00B2;</Run>
                                    </Label>
                                </StackPanel>

                                <Label Grid.Row="12" Grid.Column="0" Style="{StaticResource MyLabelPropertyName}"  Margin="50,0,0,0" Content="Delivery Truck Turnaround Area" />
                                <StackPanel Grid.Row="12" Grid.Column="1" Style="{StaticResource MyStackPanel}" >
                                    <Controls:NumericUpDown Style="{StaticResource MyNumericUpDownDeliveryTruckTurnaroundArea}" Minimum="0" Maximum="10000" Interval="10" 
                                                            Value="{Binding DeliveryTruckTurnaroundArea, Mode=TwoWay}"
                                                            ToolTip="min = 0, max = 10,000"/>
                                    <Label Style="{StaticResource MyLabelDeliveryTruckTurnaroundAreaUnits}" >
                                        <Run Typography.Variants="Superscript">ft&#x00B2;</Run>
                                    </Label>
                                </StackPanel>

                                <Label Grid.Row="13" Grid.Column="0" Style="{StaticResource MyLabelPropertyName}"  Margin="50,0,0,0" Content="Parking Lot Accessories Cost" />
                                <StackPanel Grid.Row="13" Grid.Column="1" Style="{StaticResource MyStackPanel}" >
                                    <Controls:NumericUpDown Style="{StaticResource MyNumericUpDownParkingLotAccessoriesCost}" Minimum="0" Maximum="20000" Interval="100" StringFormat="C2"
                                                            Value="{Binding ParkingLotAccessoriesCost, Mode=TwoWay}"
                                                            ToolTip="min = 0, max = 20,000"/>
                                    <Label Style="{StaticResource MyLabelParkingLotAccessoriesCostUnits}" Content="$"/>
                                </StackPanel>

                                <Label Grid.Row="14" Grid.Column="0" Style="{StaticResource MyLabelPropertyName}" Content="Geotextile Unit Cost" />
                                <StackPanel Grid.Row="14" Grid.Column="1" Style="{StaticResource MyStackPanel}" >
                                    <Controls:NumericUpDown Style="{StaticResource MyNumericUpDown}" Minimum="0" Maximum="10" Interval="0.5" StringFormat="C2"
                                                            Value="{Binding GeotextileUnitCost, Mode=TwoWay}"
                                                            ToolTip="min = 0, max = 10"/>
                                    <Label Style="{StaticResource MyLabelPropertyUnits}" >
                                        <Run Typography.Variants="Superscript">$/yd&#x00B2;</Run>
                                    </Label>
                                </StackPanel>
                            </Grid>

                        </ScrollViewer>
                    </Expander>

                    <Expander Style="{StaticResource MyExpanderESControls}">
                        <ScrollViewer CanContentScroll="True" HorizontalScrollBarVisibility="Auto" Height="300">
                            <Grid>
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition></ColumnDefinition>
                                    <ColumnDefinition></ColumnDefinition>
                                </Grid.ColumnDefinitions>

                                <Grid.RowDefinitions>
                                    <RowDefinition></RowDefinition>
                                    <RowDefinition></RowDefinition>
                                    <RowDefinition></RowDefinition>
                                    <RowDefinition></RowDefinition>
                                    <RowDefinition></RowDefinition>
                                    <RowDefinition></RowDefinition>
                                    <RowDefinition></RowDefinition>
                                    <RowDefinition></RowDefinition>
                                    <RowDefinition></RowDefinition>
                                </Grid.RowDefinitions>

                                <Grid.Resources>
                                    <converters:RadioButtonCheckedConverter x:Key="RadioButtonCheckedConverter" />
                                </Grid.Resources>

                                <RadioButton x:Name="radioButtonESControlEstimate" Grid.Row="0" Grid.Column="0" Margin="5" FontSize="14" GroupName="ESControl" Content="General E&amp;S Unit Cost" 
                                 IsChecked="{Binding ESControlOptionsProperty, Mode=TwoWay, Converter={StaticResource RadioButtonCheckedConverter}, ConverterParameter=OptionEstimate}" />

                                <RadioButton x:Name="radioButtonESControlUserSpecified" Grid.Row="1" Grid.Column="0" Margin="5" FontSize="14" GroupName="ESControl" Content="User-Specified" 
                                 IsChecked="{Binding ESControlOptionsProperty, Mode=TwoWay, Converter={StaticResource RadioButtonCheckedConverter}, ConverterParameter=OptionUserSpecified}"/>

                                <StackPanel Grid.Row="0" Grid.Column="1" Style="{StaticResource MyStackPanel}" >
                                    <Controls:NumericUpDown Style="{StaticResource MyNumericUpDownESControlUnitCostEstimate}" Minimum="0" Maximum="50000" Interval="100" StringFormat="C2"
                                                Value="{Binding ESControlUnitCostEstimate, Mode=TwoWay}"
                                                ToolTip="min = 0, max = 50,000"/>
                                    <Label Style="{StaticResource MyLabelESControlUnitCostEstimateUnits}" Content="$/acre" />
                                </StackPanel>

                                <CheckBox x:Name="checkBoxControlType" Grid.Row="2" Grid.Column="0" Margin="50,0,0,0" FontSize="14" Content="Silt Fence or Compost Filter Sock"
                                          IsChecked="{Binding IsESControlSiltFenceCompostFilterSock, Mode=TwoWay}"
                                          IsEnabled="{Binding ESControlOptionsProperty, Mode=TwoWay, Converter={StaticResource RadioButtonCheckedConverter}, ConverterParameter=OptionUserSpecified}"/>
                                <StackPanel Grid.Row="2" Grid.Column="1" Style="{StaticResource MyStackPanel}" >
                                    <Controls:DropDownButton 
                                        VerticalContentAlignment="Center"
                                        Width="150"
                                        Margin="4"
                                        Content="{Binding ESControlName}"
                                        ItemsSource="{Binding ESControlMaterials}"
                                        Style="{StaticResource MyDropDownESControlMaterials}">
                                        <Controls:DropDownButton.Resources>
                                            <models:BindingProxy x:Key="Proxy" Data="{Binding}" />
                                        </Controls:DropDownButton.Resources>
                                        <Controls:DropDownButton.ItemContainerStyle>
                                            <Style TargetType="MenuItem" BasedOn="{StaticResource {x:Type MenuItem}}">
                                                <Setter Property="Header" Value="{Binding Name}"/>
                                                <Setter Property="Command" Value="{Binding Source={StaticResource Proxy}, Path=Data.SetESControlCommand}"/>
                                                <Setter Property="CommandParameter" Value="{Binding }"/>
                                            </Style>
                                        </Controls:DropDownButton.ItemContainerStyle>
                                    </Controls:DropDownButton>
                                    <Label Style="{StaticResource MyLabelPropertyUnits}" Content="" />
                                </StackPanel>

                                <Label Grid.Row="3" Grid.Column="0" Style="{StaticResource MyLabelESControlLengthName}"  Margin="100,0,0,0" Content="Length" />
                                <StackPanel Grid.Row="3" Grid.Column="1" Style="{StaticResource MyStackPanel}" >
                                    <Controls:NumericUpDown Style="{StaticResource MyNumericUpDownESControlLength}" Minimum="0" Maximum="10000" Interval="10" 
                                                            Value="{Binding ESControlLength, Mode=TwoWay}"
                                                            ToolTip="min = 0, max = 10,000"/>
                                    <Label Style="{StaticResource MyLabelESControlLengthUnits}" Content="ft" />
                                </StackPanel>

                                <Label Grid.Row="4" Grid.Column="0" Style="{StaticResource MyLabelESControlUnitCostName}"  Margin="100,0,0,0" Content="Unit Cost" />
                                <StackPanel Grid.Row="4" Grid.Column="1" Style="{StaticResource MyStackPanel}" >
                                    <Controls:NumericUpDown Style="{StaticResource MyNumericUpDownESControlUnitCost}" Minimum="0" Maximum="25" Interval="0.25" StringFormat="C2" 
                                                            Value="{Binding ESControlUnitCost, Mode=TwoWay}"
                                                            ToolTip="min = 0, max = 25"/>
                                    <Label Style="{StaticResource MyLabelESControlUnitCostUnits}" Content="$/ft" />
                                </StackPanel>

                                <CheckBox x:Name="checkBoxSedimentBasins" Grid.Row="5" Grid.Column="0" Margin="50,0,0,0" FontSize="14" Content="Sediment Traps/Basins"
                                          IsChecked="{Binding IsSedimentBasins, Mode=TwoWay}"
                                          IsEnabled="{Binding ESControlOptionsProperty, Mode=TwoWay, Converter={StaticResource RadioButtonCheckedConverter}, ConverterParameter=OptionUserSpecified}"/>

                                <Label Grid.Row="6" Grid.Column="0" Style="{StaticResource MyLabelSedimentBasinsQuantityName}"  Margin="100,0,0,0" Content="Quantity" />
                                <StackPanel Grid.Row="6" Grid.Column="1" Style="{StaticResource MyStackPanel}" >
                                    <Controls:NumericUpDown Style="{StaticResource MyNumericUpDownSedimentBasinsQuantity}" Minimum="0" Maximum="10" Interval="1" 
                                                            Value="{Binding SedimentBasinsQuantity, Mode=TwoWay}"
                                                            ToolTip="min = 0, max = 10"/>
                                    <Label Style="{StaticResource MyLabelSedimentBasinsQuantityUnits}" Content="each" />
                                </StackPanel>

                                <Label Grid.Row="7" Grid.Column="0" Style="{StaticResource MyLabelSedimentBasinsUnitCostName}"  Margin="100,0,0,0" Content="Unit Cost" />
                                <StackPanel Grid.Row="7" Grid.Column="1" Style="{StaticResource MyStackPanel}" >
                                    <Controls:NumericUpDown Style="{StaticResource MyNumericUpDownSedimentBasinsUnitCost}" Minimum="0" Maximum="100000" Interval="500" StringFormat="C2" 
                                                            Value="{Binding SedimentBasinsUnitCost, Mode=TwoWay}"
                                                            ToolTip="min = 0, max = 100000"/>
                                    <Label Style="{StaticResource MyLabelSedimentBasinsUnitCostUnits}" Content="$/each" />
                                </StackPanel>

                                <CheckBox x:Name="checkBoxESControlOther" Grid.Row="8" Grid.Column="0" Margin="50,0,0,0" FontSize="14" Content="Other E&amp;S Cost"
                                          IsChecked="{Binding IsESControlOther, Mode=TwoWay}"
                                          IsEnabled="{Binding ESControlOptionsProperty, Mode=TwoWay, Converter={StaticResource RadioButtonCheckedConverter}, ConverterParameter=OptionUserSpecified}"/>
                                <StackPanel Grid.Row="8" Grid.Column="1" Style="{StaticResource MyStackPanel}" >
                                    <Controls:NumericUpDown Style="{StaticResource MyNumericUpDownESControlUnitCostOther}" Minimum="0" Maximum="25000" Interval="50" StringFormat="C2" 
                                                            Value="{Binding ESControlUnitCostOther, Mode=TwoWay}"
                                                            ToolTip="min = 0, max = 25,000"/>
                                    <Label Style="{StaticResource MyLabelESControlUnitCostOtherUnits}" Content="$" />
                                </StackPanel>

                            </Grid>

                        </ScrollViewer>
                    </Expander>

                    <Expander Style="{StaticResource MyExpanderDitchCulverts}">
                        <ScrollViewer CanContentScroll="True" HorizontalScrollBarVisibility="Auto" Height="330">
                            <Grid>
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition></ColumnDefinition>
                                    <ColumnDefinition></ColumnDefinition>
                                </Grid.ColumnDefinitions>

                                <Grid.RowDefinitions>
                                    <RowDefinition></RowDefinition>
                                    <RowDefinition></RowDefinition>
                                    <RowDefinition></RowDefinition>
                                    <RowDefinition></RowDefinition>
                                    <RowDefinition></RowDefinition>
                                    <RowDefinition></RowDefinition>
                                    <RowDefinition></RowDefinition>
                                    <RowDefinition></RowDefinition>
                                    <RowDefinition></RowDefinition>
                                    <RowDefinition></RowDefinition>
                                    <RowDefinition></RowDefinition>
                                    <RowDefinition></RowDefinition>
                                    <RowDefinition></RowDefinition>
                                    <RowDefinition></RowDefinition>
                                    <RowDefinition></RowDefinition>
                                    <RowDefinition></RowDefinition>
                                </Grid.RowDefinitions>

                                <Grid.Resources>
                                    <converters:RadioButtonCheckedConverter x:Key="RadioButtonCheckedConverter" />
                                </Grid.Resources>

                                <CheckBox x:Name="checkBoxRockLinedDitch" Grid.Row="0" Grid.Column="0" Margin="5" FontSize="14" Content="Rock Lined Ditch"
                                          IsChecked="{Binding IsRockLinedDitch, Mode=TwoWay}"/>

                                <Label Grid.Row="1" Grid.Column="0" Style="{StaticResource MyLabelRockLinedDitchLengthName}" Margin="50,0,0,0" Content="Ditch Length" />
                                <StackPanel Grid.Row="1" Grid.Column="1" Style="{StaticResource MyStackPanel}" >
                                    <Controls:NumericUpDown Style="{StaticResource MyNumericUpDownRockLinedDitchLength}" Minimum="0" Maximum="10000" Interval="5" 
                                                            Value="{Binding RockLinedDitchLength, Mode=TwoWay}"
                                                            ToolTip="min = 0, max = 10,000"/>
                                    <Label Style="{StaticResource MyLabelRockLinedDitchLengthUnits}" Content="ft"/>
                                </StackPanel>

                                <Label Grid.Row="2" Grid.Column="0" Style="{StaticResource MyLabelRockLinedDitchBottomWidthName}" Margin="50,0,0,0" Content="Ditch Bottom Width" />
                                <StackPanel Grid.Row="2" Grid.Column="1" Style="{StaticResource MyStackPanel}" >
                                    <Controls:NumericUpDown Style="{StaticResource MyNumericUpDownRockLinedDitchBottomWidth}" Minimum="0" Maximum="20" Interval="0.5" 
                                                            Value="{Binding RockLinedDitchBottomWidth, Mode=TwoWay}"
                                                            ToolTip="min = 0, max = 20"/>
                                    <Label Style="{StaticResource MyLabelRockLinedDitchBottomWidthUnits}" Content="ft"/>
                                </StackPanel>

                                <Label Grid.Row="3" Grid.Column="0" Style="{StaticResource MyLabelRockLinedDitchDepthName}" Margin="50,0,0,0" Content="Ditch Depth" />
                                <StackPanel Grid.Row="3" Grid.Column="1" Style="{StaticResource MyStackPanel}" >
                                    <Controls:NumericUpDown Style="{StaticResource MyNumericUpDownRockLinedDitchDepth}" Minimum="0" Maximum="10" Interval="0.5" 
                                                            Value="{Binding RockLinedDitchDepth, Mode=TwoWay}"
                                                            ToolTip="min = 0, max = 10"/>
                                    <Label Style="{StaticResource MyLabelRockLinedDitchDepthUnits}" Content="ft"/>
                                </StackPanel>

                                <Label Grid.Row="4" Grid.Column="0" Style="{StaticResource MyLabelRockLinedDitchAggregateThicknessName}" Margin="50,0,0,0" Content="Ditch Aggregate Thickness" />
                                <StackPanel Grid.Row="4" Grid.Column="1" Style="{StaticResource MyStackPanel}" >
                                    <Controls:NumericUpDown Style="{StaticResource MyNumericUpDownRockLinedDitchAggregateThickness}" Minimum="0" Maximum="10" Interval="0.5" 
                                                            Value="{Binding RockLinedDitchAggregateThickness, Mode=TwoWay}"
                                                            ToolTip="min = 0, max = 10"/>
                                    <Label Style="{StaticResource MyLabelRockLinedDitchAggregateThicknessUnits}" Content="ft"/>
                                </StackPanel>

                                <Label Grid.Row="5" Grid.Column="0" Style="{StaticResource MyLabelRockLinedDitchSideSlopeName}" Margin="50,0,0,0" Content="Ditch Side Slope" />
                                <StackPanel Grid.Row="5" Grid.Column="1" Style="{StaticResource MyStackPanel}" >
                                    <Controls:NumericUpDown Style="{StaticResource MyNumericUpDownRockLinedDitchSideSlope}" Minimum="1" Maximum="10" Interval="0.5" 
                                                            Value="{Binding RockLinedDitchSideSlope, Mode=TwoWay}"
                                                            ToolTip="min = 1, max = 10"/>
                                    <Label Style="{StaticResource MyLabelRockLinedDitchSideSlopeUnits}" Content="ft/ft"/>
                                </StackPanel>

                                <Label Grid.Row="6" Grid.Column="0" Style="{StaticResource MyLabelRockLinedDitchGeotextileLengthName}" Margin="50,0,0,0" Content="Ditch Geotextile Length" />
                                <StackPanel Grid.Row="6" Grid.Column="1" Style="{StaticResource MyStackPanel}" >
                                    <Controls:NumericUpDown Style="{StaticResource MyNumericUpDownRockLinedDitchGeotextileLength}" Minimum="0" Maximum="10000" Interval="5" 
                                                            Value="{Binding RockLinedDitchGeotextileLength, Mode=TwoWay}"
                                                            ToolTip="min = 0, max = 10,000"/>
                                    <Label Style="{StaticResource MyLabelRockLinedDitchGeotextileLengthUnits}" Content="ft"/>
                                </StackPanel>

                                <Label Grid.Row="7" Grid.Column="0" Style="{StaticResource MyLabelRockLinedDitchAggregateBulkDensityName}" Margin="50,0,0,0" Content="Aggregate Bulk Density" />
                                <StackPanel Grid.Row="7" Grid.Column="1" Style="{StaticResource MyStackPanel}" >
                                    <Controls:NumericUpDown Style="{StaticResource MyNumericUpDownRockLinedDitchAggregateBulkDensity}" Minimum="1" Maximum="2" Interval="0.05" 
                                                            Value="{Binding RockLinedDitchAggregateBulkDensity, Mode=TwoWay}"
                                                            ToolTip="min = 1, max = 2"/>
                                    <Label Style="{StaticResource MyLabelRockLinedDitchAggregateBulkDensityUnits}" >
                                        <Run Typography.Variants="Superscript">ton/yd&#x00B3;</Run>
                                    </Label>
                                </StackPanel>

                                <Label Grid.Row="8" Grid.Column="0" Style="{StaticResource MyLabelRockLinedDitchAggregateUnitCostName}" Margin="50,0,0,0" Content="Aggregate Unit Cost" />
                                <StackPanel Grid.Row="8" Grid.Column="1" Style="{StaticResource MyStackPanel}" >
                                    <Controls:NumericUpDown Style="{StaticResource MyNumericUpDownRockLinedDitchAggregateUnitCost}" Minimum="0" Maximum="100" Interval="1" StringFormat="C2"
                                                            Value="{Binding RockLinedDitchAggregateUnitCost, Mode=TwoWay}"
                                                            ToolTip="min = 0, max = 100"/>
                                    <Label Style="{StaticResource MyLabelRockLinedDitchAggregateUnitCostUnits}" Content="$/ton"/>
                                </StackPanel>

                                <Label Grid.Row="9" Grid.Column="0" Style="{StaticResource MyLabelRockLinedDitchAggregatePlacementUnitCostName}"  Margin="50,0,0,0" Content="Aggregate Placement Unit Cost" Width="300" />
                                <StackPanel Grid.Row="9" Grid.Column="1" Style="{StaticResource MyStackPanel}" >
                                    <Controls:NumericUpDown Style="{StaticResource MyNumericUpDownRockLinedDitchAggregatePlacementUnitCost}" Minimum="0" Maximum="100" Interval="1" StringFormat="C2" 
                                                            Value="{Binding RockLinedDitchAggregatePlacementUnitCost, Mode=TwoWay}"
                                                            ToolTip="min = 0, max = 100"/>
                                    <Label Style="{StaticResource MyLabelRockLinedDitchAggregatePlacementUnitCostUnits}" >
                                        <Run Typography.Variants="Superscript">$/yd&#x00B3;</Run>
                                    </Label>
                                </StackPanel>

                                <CheckBox x:Name="checkBoxVegetatedDitch" Grid.Row="10" Grid.Column="0" Margin="5" FontSize="14" Content="Vegetated Ditch"
                                          IsChecked="{Binding IsVegetatedDitch, Mode=TwoWay}"/>

                                <Label Grid.Row="11" Grid.Column="0" Style="{StaticResource MyLabelVegetatedDitchLengthName}" Margin="50,0,0,0" Content="Length" />
                                <StackPanel Grid.Row="11" Grid.Column="1" Style="{StaticResource MyStackPanel}" >
                                    <Controls:NumericUpDown Style="{StaticResource MyNumericUpDownVegetatedDitchLength}" Minimum="0" Maximum="10000" Interval="5" 
                                                            Value="{Binding VegetatedDitchLength, Mode=TwoWay}"
                                                            ToolTip="min = 0, max = 10,000"/>
                                    <Label Style="{StaticResource MyLabelVegetatedDitchLengthUnits}" Content="ft"/>
                                </StackPanel>

                                <Label Grid.Row="12" Grid.Column="0" Style="{StaticResource MyLabelVegetatedDitchUnitCostName}" Margin="50,0,0,0" Content="Unit Cost" />
                                <StackPanel Grid.Row="12" Grid.Column="1" Style="{StaticResource MyStackPanel}" >
                                    <Controls:NumericUpDown Style="{StaticResource MyNumericUpDownVegetatedDitchUnitCost}" Minimum="0" Maximum="100" Interval="0.5" StringFormat="C2"
                                                            Value="{Binding VegetatedDitchUnitCost, Mode=TwoWay}"
                                                            ToolTip="min = 0, max = 100"/>
                                    <Label Style="{StaticResource MyLabelVegetatedDitchUnitCostUnits}" Content="$/ft"/>
                                </StackPanel>

                                <CheckBox x:Name="checkBoxCulvert" Grid.Row="13" Grid.Column="0" Margin="5" FontSize="14" Content="Culvert"
                                          IsChecked="{Binding IsCulvert, Mode=TwoWay}"/>

                                <Label Grid.Row="14" Grid.Column="0" Style="{StaticResource MyLabelCulvertLengthName}" Margin="50,0,0,0" Content="Length" />
                                <StackPanel Grid.Row="14" Grid.Column="1" Style="{StaticResource MyStackPanel}" >
                                    <Controls:NumericUpDown Style="{StaticResource MyNumericUpDownCulvertLength}" Minimum="0" Maximum="1000" Interval="1" 
                                                            Value="{Binding CulvertLength, Mode=TwoWay}"
                                                            ToolTip="min = 0, max = 1,000"/>
                                    <Label Style="{StaticResource MyLabelCulvertLengthUnits}" Content="ft"/>
                                </StackPanel>

                                <Label Grid.Row="15" Grid.Column="0" Style="{StaticResource MyLabelCulvertUnitCostName}" Margin="50,0,0,0" Content="Unit Cost" />
                                <StackPanel Grid.Row="15" Grid.Column="1" Style="{StaticResource MyStackPanel}" >
                                    <Controls:NumericUpDown Style="{StaticResource MyNumericUpDownCulvertUnitCost}" Minimum="0" Maximum="500" Interval="1" StringFormat="C2"
                                                            Value="{Binding CulvertUnitCost, Mode=TwoWay}"
                                                            ToolTip="min = 0, max = 500"/>
                                    <Label Style="{StaticResource MyLabelCulvertUnitCostUnits}" Content="$/ft"/>
                                </StackPanel>

                            </Grid>

                        </ScrollViewer>
                    </Expander>

                    <Expander Style="{StaticResource MyExpanderControlBuilding}">
                        <ScrollViewer CanContentScroll="True" HorizontalScrollBarVisibility="Auto" Height="450">
                            <Grid>
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition></ColumnDefinition>
                                    <ColumnDefinition></ColumnDefinition>
                                </Grid.ColumnDefinitions>

                                <Grid.RowDefinitions>
                                    <RowDefinition></RowDefinition>
                                    <RowDefinition></RowDefinition>
                                    <RowDefinition></RowDefinition>
                                    <RowDefinition></RowDefinition>
                                    <RowDefinition></RowDefinition>
                                    <RowDefinition></RowDefinition>
                                    <RowDefinition></RowDefinition>
                                    <RowDefinition></RowDefinition>
                                    <RowDefinition></RowDefinition>
                                    <RowDefinition></RowDefinition>
                                    <RowDefinition></RowDefinition>
                                    <RowDefinition></RowDefinition>
                                    <RowDefinition></RowDefinition>
                                    <RowDefinition></RowDefinition>
                                </Grid.RowDefinitions>

                                <Grid.Resources>
                                    <converters:RadioButtonCheckedConverter x:Key="RadioButtonCheckedConverter" />
                                </Grid.Resources>

                                <Label Grid.Row="0" Grid.Column="0" Style="{StaticResource MyLabelPropertyName}" Content="Foundation/Slab Volume" Margin="2,2,0,2" />

                                <RadioButton x:Name="radioButtonFoundationEstimate" Grid.Row="1" Grid.Column="0" Margin="50,0,0,0" FontSize="14" GroupName="FoundationVolume" Content="Estimate" 
                                 IsChecked="{Binding FoundationVolumeOptionsProperty, Mode=TwoWay, Converter={StaticResource RadioButtonCheckedConverter}, ConverterParameter=OptionEstimate}" />

                                <StackPanel Grid.Row="1" Grid.Column="1" Style="{StaticResource MyStackPanel}">
                                    <Label Style="{StaticResource MyLabelFoundationSiteSoilName}" Content="Site Soils Condition" />
                                    <Controls:DropDownButton 
                                        VerticalContentAlignment="Center"
                                        Width="120"
                                        Margin="4"
                                        Content="{Binding FoundationSiteSoilName}"
                                        ItemsSource="{Binding FoundationSiteSoils}"
                                        Style="{StaticResource MyDropDownFoundationSiteSoils}">
                                        <Controls:DropDownButton.Resources>
                                            <models:BindingProxy x:Key="Proxy" Data="{Binding}" />
                                        </Controls:DropDownButton.Resources>
                                        <Controls:DropDownButton.ItemContainerStyle>
                                            <Style TargetType="MenuItem" BasedOn="{StaticResource {x:Type MenuItem}}">
                                                <Setter Property="Header" Value="{Binding Name}"/>
                                                <Setter Property="Command" Value="{Binding Source={StaticResource Proxy}, Path=Data.SetFoundationSiteSoilCommand}"/>
                                                <Setter Property="CommandParameter" Value="{Binding }"/>
                                            </Style>
                                        </Controls:DropDownButton.ItemContainerStyle>
                                    </Controls:DropDownButton>
                                    <Label Style="{StaticResource MyLabelPropertyUnits}" Content="" />
                                </StackPanel>

                                <StackPanel Grid.Row="2" Grid.Column="1" Style="{StaticResource MyStackPanel}"  >
                                    <Label Style="{StaticResource MyLabelFoundationDepthName}" Content="Foundation Depth" />
                                    <Controls:NumericUpDown Style="{StaticResource MyNumericUpDownFoundationDepth}" Minimum="0" Maximum="10" Interval="0.5" 
                                                Value="{Binding FoundationDepth, Mode=TwoWay}"
                                                ToolTip="min = 0, max = 10"/>
                                    <Label Style="{StaticResource MyLabelFoundationDepthUnits}" Content="ft"/>
                                </StackPanel>

                                <StackPanel Grid.Row="3" Grid.Column="1" Style="{StaticResource MyStackPanel}"  >
                                    <Label Style="{StaticResource MyLabelFoundationConcreteUnitCostName}" Content="Concrete Unit Cost" />
                                    <Controls:NumericUpDown Style="{StaticResource MyNumericUpDownFoundationConcreteUnitCost}" Minimum="0" Maximum="1000" Interval="5" StringFormat="C2"
                                                Value="{Binding FoundationConcreteUnitCost, Mode=TwoWay}"
                                                ToolTip="min = 0, max = 1,000"/>
                                    <Label Style="{StaticResource MyLabelFoundationConcreteUnitCostUnits}" >
                                        <Run Typography.Variants="Superscript">$/yd&#x00B3;</Run>
                                    </Label>
                                </StackPanel>

                                <RadioButton x:Name="radioButtonFoundationUserSpecified" Grid.Row="4" Grid.Column="0" Margin="50,0,0,0" FontSize="14" GroupName="FoundationVolume" Content="User-Specified" 
                                 IsChecked="{Binding FoundationVolumeOptionsProperty, Mode=TwoWay, Converter={StaticResource RadioButtonCheckedConverter}, ConverterParameter=OptionUserSpecified}"/>

                                <StackPanel Grid.Row="4" Grid.Column="1" Style="{StaticResource MyStackPanel}"  >
                                    <Label Style="{StaticResource MyLabelFoundationSlabVolumeUserSpecifiedName}" Content="Volume" />
                                    <Controls:NumericUpDown Style="{StaticResource MyNumericUpDownFoundationSlabVolumeUserSpecified}" Minimum="0" Maximum="500" Interval="1" 
                                                Value="{Binding FoundationSlabVolumeUserSpecified, Mode=TwoWay}"
                                                ToolTip="min = 0, max = 500"/>
                                    <Label Style="{StaticResource MyLabelFoundationSlabVolumeUserSpecifiedUnits}" >
                                        <Run Typography.Variants="Superscript">yd&#x00B3;</Run>
                                    </Label>
                                </StackPanel>

                                <Label Grid.Row="5" Grid.Column="0" Style="{StaticResource MyLabelPropertyName}" Content="Steel Building" Margin="2,2,0,2" />

                                <RadioButton x:Name="radioButtonControlBuildingEstimate" Grid.Row="6" Grid.Column="0" Margin="50,0,0,0" FontSize="14" GroupName="ControlBuilding" Content="Estimate" 
                                 IsChecked="{Binding ControlBuildingOptionsProperty, Mode=TwoWay, Converter={StaticResource RadioButtonCheckedConverter}, ConverterParameter=OptionEstimate}" />
                                
                                <StackPanel Grid.Row="7" Grid.Column="1" Style="{StaticResource MyStackPanel}"  >
                                    <Label Style="{StaticResource MyLabelControlBuildingLengthName}" Content="Building Length" />
                                    <Controls:NumericUpDown Style="{StaticResource MyNumericUpDownControlBuildingLength}" Minimum="0" Maximum="100" Interval="1"  
                                                            Value="{Binding ControlBuildingLength, Mode=TwoWay}"
                                                            ToolTip="min = 0, max = 100"/>
                                    <Label Style="{StaticResource MyLabelControlBuildingLengthUnits}" Content="ft"/>
                                </StackPanel>

                                <StackPanel Grid.Row="8" Grid.Column="1" Style="{StaticResource MyStackPanel}"  >
                                    <Label  Style="{StaticResource MyLabelControlBuildingWidthName}" Content="Building Width" />
                                    <Controls:NumericUpDown Style="{StaticResource MyNumericUpDownControlBuildingWidth}" Minimum="0" Maximum="100" Interval="1"  
                                                            Value="{Binding ControlBuildingWidth, Mode=TwoWay}"
                                                            ToolTip="min = 0, max = 100"/>
                                    <Label Style="{StaticResource MyLabelControlBuildingWidthUnits}" Content="ft"/>
                                </StackPanel>

                                <StackPanel Grid.Row="9" Grid.Column="1" Style="{StaticResource MyStackPanel}" >
                                    <Label Style="{StaticResource MyLabelControlBuildingUnitCostName}" Content="Square Foot Unit Cost" />
                                    <Controls:NumericUpDown Style="{StaticResource MyNumericUpDownControlBuildingUnitCost}" Minimum="0" Maximum="1000" Interval="1" StringFormat="C2"
                                                            Value="{Binding ControlBuildingUnitCost, Mode=TwoWay}"
                                                            ToolTip="min = 0, max = 1,000"/>
                                    <Label Style="{StaticResource MyLabelControlBuildingUnitCostUnits}" >
                                        <Run Typography.Variants="Superscript">$/ft&#x00B2;</Run>
                                    </Label>
                                </StackPanel>

                                <CheckBox x:Name="checkBoxLab" Grid.Row="10" Grid.Column="0" Margin="100,0,0,0" FontSize="14" Content="Lab"
                                          IsChecked="{Binding IsLab, Mode=TwoWay}"
                                          IsEnabled="{Binding ControlBuildingOptionsProperty, Mode=TwoWay, Converter={StaticResource RadioButtonCheckedConverter}, ConverterParameter=OptionEstimate}"/>
                                <StackPanel Grid.Row="10" Grid.Column="1" Style="{StaticResource MyStackPanel}" >
                                    <Label Style="{StaticResource MyLabelControlBuildingLabCostName}" Content="Cost" />
                                    <Controls:NumericUpDown Style="{StaticResource MyNumericUpDownControlBuildingLabCost}" Minimum="0" Maximum="100000" Interval="100" StringFormat="C2"
                                                            Value="{Binding ControlBuildingLabCost, Mode=TwoWay}"
                                                            ToolTip="min = 0, max = 100,000"/>
                                    <Label Style="{StaticResource MyLabelControlBuildingLabCostUnits}" Content="$"/>
                                </StackPanel>

                                <CheckBox x:Name="checkBoxWaterSewer" Grid.Row="11" Grid.Column="0" Margin="100,0,0,0" FontSize="14" Content="Water and/or Sewer"
                                          IsChecked="{Binding IsWaterSewer, Mode=TwoWay}"
                                          IsEnabled="{Binding ControlBuildingOptionsProperty, Mode=TwoWay, Converter={StaticResource RadioButtonCheckedConverter}, ConverterParameter=OptionEstimate}"/>
                                <StackPanel Grid.Row="11" Grid.Column="1" Style="{StaticResource MyStackPanel}" >
                                    <Label Style="{StaticResource MyLabelControlBuildingWaterSewerCostName}" Content="Cost" />
                                    <Controls:NumericUpDown Style="{StaticResource MyNumericUpDownControlBuildingWaterSewerCost}" Minimum="0" Maximum="100000" Interval="100" StringFormat="C2"
                                                            Value="{Binding ControlBuildingWaterSewerCost, Mode=TwoWay}"
                                                            ToolTip="min = 0, max = 100,000"/>
                                    <Label Style="{StaticResource MyLabelControlBuildingWaterSewerCostUnits}" Content="$"/>
                                </StackPanel>

                                <CheckBox x:Name="checkBoxHVAC" Grid.Row="12" Grid.Column="0" Margin="100,0,0,0" FontSize="14" Content="HVAC"
                                          IsChecked="{Binding IsHVAC, Mode=TwoWay}"
                                          IsEnabled="{Binding ControlBuildingOptionsProperty, Mode=TwoWay, Converter={StaticResource RadioButtonCheckedConverter}, ConverterParameter=OptionEstimate}"/>
                                <StackPanel Grid.Row="12" Grid.Column="1" Style="{StaticResource MyStackPanel}" >
                                    <Label Style="{StaticResource MyLabelControlBuildingHVACCostName}" Content="Cost" />
                                    <Controls:NumericUpDown Style="{StaticResource MyNumericUpDownControlBuildingHVACCost}" Minimum="0" Maximum="100000" Interval="100" StringFormat="C2"
                                                            Value="{Binding ControlBuildingHVACCost, Mode=TwoWay}"
                                                            ToolTip="min = 0, max = 100,000"/>
                                    <Label Style="{StaticResource MyLabelControlBuildingHVACCostUnits}" Content="$"/>
                                </StackPanel>

                                <RadioButton x:Name="radioButtonControlBuildingUserSpecified" Grid.Row="13" Grid.Column="0" Margin="50,0,0,0" FontSize="14" GroupName="ControlBuilding" Content="User-Specified" 
                                 IsChecked="{Binding ControlBuildingOptionsProperty, Mode=TwoWay, Converter={StaticResource RadioButtonCheckedConverter}, ConverterParameter=OptionUserSpecified}"/>

                                <StackPanel Grid.Row="13" Grid.Column="1" Style="{StaticResource MyStackPanel}" >
                                    <Label Style="{StaticResource MyLabelControlBuildingCostUserSpecifiedName}" Content="Cost" />
                                    <Controls:NumericUpDown Style="{StaticResource MyNumericUpDownControlBuildingCostUserSpecified}" Minimum="0" Maximum="500000" Interval="100" StringFormat="C2"
                                                Value="{Binding ControlBuildingCostUserSpecified, Mode=TwoWay}"
                                                ToolTip="min = 0, max = 500,000"/>
                                    <Label Style="{StaticResource MyLabelControlBuildingCostUserSpecifiedUnits}" Content="$" />
                                </StackPanel>
                            </Grid>

                        </ScrollViewer>
                    </Expander>

                    <Expander Style="{StaticResource MyExpanderElectric}">
                        <ScrollViewer CanContentScroll="True" HorizontalScrollBarVisibility="Auto" Height="330">
                            <Grid>
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition></ColumnDefinition>
                                    <ColumnDefinition></ColumnDefinition>
                                </Grid.ColumnDefinitions>

                                <Grid.RowDefinitions>
                                    <RowDefinition></RowDefinition>
                                    <RowDefinition></RowDefinition>
                                    <RowDefinition></RowDefinition>
                                    <RowDefinition></RowDefinition>
                                    <RowDefinition></RowDefinition>
                                    <RowDefinition></RowDefinition>
                                    <RowDefinition></RowDefinition>
                                    <RowDefinition></RowDefinition>
                                    <RowDefinition></RowDefinition>
                                </Grid.RowDefinitions>

                                <Label Grid.Row="0" Grid.Column="0" Style="{StaticResource MyLabelPropertyName}" Content="Electric Line Extension Length" />
                                <StackPanel Grid.Row="0" Grid.Column="1" Style="{StaticResource MyStackPanel}"  >
                                    <Controls:NumericUpDown Style="{StaticResource MyNumericUpDown}" Minimum="0" Maximum="10000" Interval="5"
                                                Value="{Binding ElectricLineExtensionLength, Mode=TwoWay}"
                                                ToolTip="min = 0, max = 10,000"/>
                                    <Label Style="{StaticResource MyLabelPropertyUnits}" Content="ft" />
                                </StackPanel>

                                <Label Grid.Row="1" Grid.Column="0" Style="{StaticResource MyLabelPropertyName}" Content="Electric Line Unit Cost" />
                                <StackPanel Grid.Row="1" Grid.Column="1" Style="{StaticResource MyStackPanel}"  >
                                    <Controls:NumericUpDown Style="{StaticResource MyNumericUpDown}" Minimum="0" Maximum="200" Interval="1" StringFormat="C2"
                                                Value="{Binding ElectricLineExtensionUnitCost, Mode=TwoWay}"
                                                ToolTip="min = 0, max = 200"/>
                                    <Label Style="{StaticResource MyLabelPropertyUnits}" Content="$/ft" />
                                </StackPanel>

                                <Label Grid.Row="2" Grid.Column="0" Style="{StaticResource MyLabelPropertyName}" Content="Back-up Generator Cost" />
                                <StackPanel Grid.Row="2" Grid.Column="1" Style="{StaticResource MyStackPanel}"  >
                                    <Controls:NumericUpDown Style="{StaticResource MyNumericUpDown}" Minimum="0" Maximum="500000" Interval="500" StringFormat="C2"
                                                Value="{Binding ElectricBackupGeneratorCost, Mode=TwoWay}"
                                                ToolTip="min = 0, max = 500,000"/>
                                    <Label Style="{StaticResource MyLabelPropertyUnits}" Content="$" />
                                </StackPanel>

                                <CheckBox x:Name="checkBoxStepdownTransformer" Grid.Row="3" Grid.Column="0" FontSize="14" Margin="5" Content="Stepdown Transformer (15 KV to 460 V)"
                                          IsChecked="{Binding IsStepdownTransformer, Mode=TwoWay}"/>
                                <StackPanel Grid.Row="3" Grid.Column="1" Style="{StaticResource MyStackPanel}" >
                                    <Label Style="{StaticResource MyLabelElectricStepdownTransformerCostName}" Content="Cost" />
                                    <Controls:NumericUpDown Style="{StaticResource MyNumericUpDownElectricStepdownTransformerCost}" Minimum="0" Maximum="500000" Interval="500" StringFormat="C2"
                                                            Value="{Binding ElectricStepdownTransformerCost, Mode=TwoWay}"
                                                            ToolTip="min = 0, max = 500,000"/>
                                    <Label Style="{StaticResource MyLabelElectricStepdownTransformerCostUnits}" Content="$"/>
                                </StackPanel>

                                <Label Grid.Row="4" Grid.Column="0" Style="{StaticResource MyLabelPropertyName}" Content="Electric Panel Cost" />
                                <StackPanel Grid.Row="4" Grid.Column="1" Style="{StaticResource MyStackPanel}"  >
                                    <Controls:NumericUpDown Style="{StaticResource MyNumericUpDown}" Minimum="0" Maximum="50000" Interval="100" StringFormat="C2"
                                                Value="{Binding ElectricPanelCost, Mode=TwoWay}"
                                                ToolTip="min = 0, max = 50,000"/>
                                    <Label Style="{StaticResource MyLabelPropertyUnits}" Content="$" />
                                </StackPanel>

                                <Label Grid.Row="5" Grid.Column="0" Style="{StaticResource MyLabelPropertyName}" Content="Wiring Estimate as % of Equipment Cost" />
                                <StackPanel Grid.Row="5" Grid.Column="1" Style="{StaticResource MyStackPanel}"  >
                                    <Controls:NumericUpDown Style="{StaticResource MyNumericUpDown}" Minimum="0" Maximum="25" Interval="0.5" 
                                                Value="{Binding ElectricWiringPercentage, Mode=TwoWay}"
                                                ToolTip="min = 0, max = 25"/>
                                    <Label Style="{StaticResource MyLabelPropertyUnits}" Content="%" />
                                </StackPanel>

                                <CheckBox x:Name="checkBoxTelecommunications" Grid.Row="6" Grid.Column="0" FontSize="14" Margin="5" Content="Telecommunications"
                                          IsChecked="{Binding IsTelecommunications, Mode=TwoWay}"/>
                                <StackPanel Grid.Row="6" Grid.Column="1" Style="{StaticResource MyStackPanel}" >
                                    <Label Style="{StaticResource MyLabelElectricTelecommunicationsCostName}" Content="Cost" />
                                    <Controls:NumericUpDown Style="{StaticResource MyNumericUpDownElectricTelecommunicationsCost}" Minimum="0" Maximum="100000" Interval="100" StringFormat="C2"
                                                            Value="{Binding ElectricTelecommunicationsCost, Mode=TwoWay}"
                                                            ToolTip="min = 0, max = 100,000"/>
                                    <Label Style="{StaticResource MyLabelElectricTelecommunicationsCostUnits}" Content="$"/>
                                </StackPanel>

                                <CheckBox x:Name="checkBoxPlantAutomation" Grid.Row="7" Grid.Column="0" FontSize="14" Margin="5" Content="Plant Automation"
                                          IsChecked="{Binding IsPlantAutomation, Mode=TwoWay}"/>
                                <StackPanel Grid.Row="7" Grid.Column="1" Style="{StaticResource MyStackPanel}" >
                                    <Label Style="{StaticResource MyLabelElectricPlantAutomationCostName}" Content="Cost" />
                                    <Controls:NumericUpDown Style="{StaticResource MyNumericUpDownElectricPlantAutomationCost}" Minimum="0" Maximum="500000" Interval="500" StringFormat="C2"
                                                            Value="{Binding ElectricPlantAutomationCost, Mode=TwoWay}"
                                                            ToolTip="min = 0, max = 500,000"/>
                                    <Label Style="{StaticResource MyLabelElectricPlantAutomationCostUnits}" Content="$"/>
                                </StackPanel>

                                <CheckBox x:Name="checkBoxElectricOtherUtility" Grid.Row="8" Grid.Column="0" FontSize="14" Margin="5" Content="Other Utility"
                                          IsChecked="{Binding IsElectricOtherUtility, Mode=TwoWay}"/>
                                <StackPanel Grid.Row="8" Grid.Column="1" Style="{StaticResource MyStackPanel}" >
                                    <Label Style="{StaticResource MyLabelElectricOtherUtilityCostName}" Content="Cost" />
                                    <Controls:NumericUpDown Style="{StaticResource MyNumericUpDownElectricOtherUtilityCost}" Minimum="0" Maximum="100000" Interval="100" StringFormat="C2"
                                                            Value="{Binding ElectricOtherUtilityCost, Mode=TwoWay}"
                                                            ToolTip="min = 0, max = 100,000"/>
                                    <Label Style="{StaticResource MyLabelElectricOtherUtilityCostUnits}" Content="$"/>
                                </StackPanel>
                            </Grid>

                        </ScrollViewer>
                    </Expander>

                    <Expander Style="{StaticResource MyExpanderFencingAccessGates}">
                        <ScrollViewer CanContentScroll="True" HorizontalScrollBarVisibility="Auto" Height="200">
                            <Grid>
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition></ColumnDefinition>
                                    <ColumnDefinition></ColumnDefinition>
                                </Grid.ColumnDefinitions>

                                <Grid.RowDefinitions>
                                    <RowDefinition></RowDefinition>
                                    <RowDefinition></RowDefinition>
                                    <RowDefinition></RowDefinition>
                                    <RowDefinition></RowDefinition>
                                    <RowDefinition></RowDefinition>
                                    <RowDefinition></RowDefinition>
                                </Grid.RowDefinitions>

                                <Grid.Resources>
                                    <converters:RadioButtonCheckedConverter x:Key="RadioButtonCheckedConverter" />
                                </Grid.Resources>

                                <!--<RadioButton x:Name="radioButtonFencingKnown" Grid.Row="0" Grid.Column="0" Margin="5" FontSize="14" GroupName="Fencing" Content="Known Quantity &amp; Unit Cost" 
                                 IsChecked="{Binding FencingOptionsProperty, Mode=TwoWay, Converter={StaticResource RadioButtonCheckedConverter}, ConverterParameter=OptionKn}"/>-->

                                <RadioButton x:Name="radioButtonOptionKnown" Grid.Row="0" Grid.Column="0" Margin="5" FontSize="14" GroupName="Fencing" Content="Known Fence Quantity &amp; Unit Cost" 
                                 IsChecked="{Binding FencingOptionsProperty, Mode=TwoWay, Converter={StaticResource RadioButtonCheckedConverter}, ConverterParameter=OptionKnown}" />

                                <StackPanel Grid.Row="0" Grid.Column="1" Style="{StaticResource MyStackPanel}" >
                                    <Label Style="{StaticResource MyLabelFencingLengthName}" Content="Length" />
                                    <Controls:NumericUpDown Style="{StaticResource MyNumericUpDownFencingLength}" Minimum="0" Maximum="20000" Interval="10" 
                                                Value="{Binding FencingLength, Mode=TwoWay}"
                                                ToolTip="min = 0, max = 20,000"/>
                                    <Label Style="{StaticResource MyLabelFencingLengthUnits}" Content="ft" />
                                </StackPanel>

                                <StackPanel Grid.Row="1" Grid.Column="1" Style="{StaticResource MyStackPanel}" >
                                    <Label Style="{StaticResource MyLabelFencingUnitCostName}" Content="Unit Cost" />
                                    <Controls:NumericUpDown Style="{StaticResource MyNumericUpDownFencingUnitCost}" Minimum="0" Maximum="100" Interval="1" StringFormat="C2"
                                                Value="{Binding FencingUnitCost, Mode=TwoWay}"
                                                ToolTip="min = 0, max = 100"/>
                                    <Label Style="{StaticResource MyLabelFencingUnitCostUnits}" Content="$/ft" />
                                </StackPanel>
                                
                                <RadioButton x:Name="radioButtonOptionEstimate" Grid.Row="2" Grid.Column="0" Margin="5" FontSize="14" GroupName="Fencing" Content="Estimate Fence Quantity" 
                                 IsChecked="{Binding FencingOptionsProperty, Mode=TwoWay, Converter={StaticResource RadioButtonCheckedConverter}, ConverterParameter=OptionEstimate}" />

                                <RadioButton x:Name="radioButtonOptionUserSpecified" Grid.Row="3" Grid.Column="0" Margin="5" FontSize="14" GroupName="Fencing" Content="User-Specified Fencing Cost" 
                                 IsChecked="{Binding FencingOptionsProperty, Mode=TwoWay, Converter={StaticResource RadioButtonCheckedConverter}, ConverterParameter=OptionUserSpecified}"/>
                                
                                <StackPanel Grid.Row="3" Grid.Column="1" Style="{StaticResource MyStackPanel}" >
                                    <Label Style="{StaticResource MyLabelFencingCostUserSpecifiedName}" Content="Cost" />
                                    <Controls:NumericUpDown Style="{StaticResource MyNumericUpDownFencingCostUserSpecified}" Minimum="0" Maximum="100000" Interval="100" StringFormat="C2"
                                                Value="{Binding FencingCostUserSpecified, Mode=TwoWay}"
                                                ToolTip="min = 0, max = 100"/>
                                    <Label Style="{StaticResource MyLabelFencingCostUserSpecifiedUnits}" Content="$" />
                                </StackPanel>


                                <CheckBox x:Name="checkBoxAccessGate" Grid.Row="4" Grid.Column="0" FontSize="14" Margin="5" Content="Lockable Access Gate"
                                          IsChecked="{Binding IsAccessGate, Mode=TwoWay}"/>
                                <StackPanel Grid.Row="4" Grid.Column="1" Style="{StaticResource MyStackPanel}" >
                                    <Label Style="{StaticResource MyLabelAccessGateQuantityName}" Content="Quantity" />
                                    <Controls:NumericUpDown Style="{StaticResource MyNumericUpDownAccessGateQuantity}" Minimum="0" Maximum="10" Interval="1" 
                                                            Value="{Binding AccessGateQuantity, Mode=TwoWay}"
                                                            ToolTip="min = 0, max = 10"/>
                                    <Label Style="{StaticResource MyLabelAccessGateQuantityUnits}" Content="each"/>
                                </StackPanel>

                                <StackPanel Grid.Row="5" Grid.Column="1" Style="{StaticResource MyStackPanel}" >
                                    <Label Style="{StaticResource MyLabelAccessGateUnitCostName}" Content="Unit Cost" />
                                    <Controls:NumericUpDown Style="{StaticResource MyNumericUpDownAccessGateUnitCost}" Minimum="0" Maximum="25000" Interval="100" 
                                                            Value="{Binding AccessGateUnitCost, Mode=TwoWay}"
                                                            ToolTip="min = 0, max = 25,000"/>
                                    <Label Style="{StaticResource MyLabelAccessGateUnitCostUnits}" Content="$/each"/>
                                </StackPanel>
                                
                            </Grid>

                        </ScrollViewer>
                    </Expander>

                    <Expander Style="{StaticResource MyExpanderClearing}">
                        <ScrollViewer CanContentScroll="True" HorizontalScrollBarVisibility="Auto" Height="100">
                            <Grid>
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition></ColumnDefinition>
                                    <ColumnDefinition></ColumnDefinition>
                                </Grid.ColumnDefinitions>

                                <Grid.RowDefinitions>
                                    <RowDefinition></RowDefinition>
                                    <RowDefinition></RowDefinition>
                                    <RowDefinition></RowDefinition>
                                </Grid.RowDefinitions>

                                <Label Grid.Row="0" Grid.Column="0" Style="{StaticResource MyLabelPropertyName}" Content="Clearing and Grubbing Unit Cost" />
                                <StackPanel Grid.Row="0" Grid.Column="1" Style="{StaticResource MyStackPanel}" >
                                    <Controls:NumericUpDown Style="{StaticResource MyNumericUpDown}" Minimum="0" Maximum="10000" Interval="50" StringFormat="C2"
                                                            Value="{Binding ClearAndGrubUnitCost, Mode=TwoWay}"
                                                            ToolTip="min = 0, max = 10,000"/>
                                    <Label Style="{StaticResource MyLabelPropertyUnits}" Content="$/acre" />
                                </StackPanel>

                                <Label Grid.Row="1" Grid.Column="0" Style="{StaticResource MyLabelPropertyName}" Content="Clear and Grub Revegetation Percentage" />
                                <StackPanel Grid.Row="1" Grid.Column="1" Style="{StaticResource MyStackPanel}" >
                                    <Controls:NumericUpDown Style="{StaticResource MyNumericUpDown}" Minimum="0" Maximum="100" Interval="1" 
                                                            Value="{Binding ClearAndGrubRevegetationPercentage, Mode=TwoWay}"
                                                            ToolTip="min = 0, max = 100"/>
                                    <Label Style="{StaticResource MyLabelPropertyUnits}" Content="%" />
                                </StackPanel>

                                <Label Grid.Row="2" Grid.Column="0" Style="{StaticResource MyLabelPropertyName}" Content="Revegetation Unit Cost" />
                                <StackPanel Grid.Row="2" Grid.Column="1" Style="{StaticResource MyStackPanel}" >
                                    <Controls:NumericUpDown Style="{StaticResource MyNumericUpDown}" Minimum="0" Maximum="10000" Interval="50" StringFormat="C2"
                                                            Value="{Binding RevegetationUnitCost, Mode=TwoWay}"
                                                            ToolTip="min = 0, max = 10,000"/>
                                    <Label Style="{StaticResource MyLabelPropertyUnits}" Content="$/acre" />
                                </StackPanel>



                            </Grid>

                        </ScrollViewer>
                    </Expander>

                    <Expander Style="{StaticResource MyExpanderEngineering}">
                        <ScrollViewer CanContentScroll="True" HorizontalScrollBarVisibility="Auto" Height="300">
                            <Grid>
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition></ColumnDefinition>
                                    <ColumnDefinition></ColumnDefinition>
                                </Grid.ColumnDefinitions>

                                <Grid.RowDefinitions>
                                    <RowDefinition></RowDefinition>
                                    <RowDefinition></RowDefinition>
                                    <RowDefinition></RowDefinition>
                                    <RowDefinition></RowDefinition>
                                    <RowDefinition></RowDefinition>
                                    <RowDefinition></RowDefinition>
                                    <RowDefinition></RowDefinition>
                                    <RowDefinition></RowDefinition>
                                    <RowDefinition></RowDefinition>
                                </Grid.RowDefinitions>

                                <Grid.Resources>
                                    <converters:RadioButtonCheckedConverter x:Key="RadioButtonCheckedConverter" />
                                </Grid.Resources>
                                
                                <CheckBox x:Name="checkBoxEngineeringPermitting" Grid.Row="0" Grid.Column="0" FontSize="14" Margin="5" Content="Engineering/Permitting"
                                          IsChecked="{Binding IsEngineeringPermitting, Mode=TwoWay}"/>

                                <RadioButton x:Name="radioButtonEngineeringPermittingEstimate" Grid.Row="1" Grid.Column="0" Margin="50,0,0,0" FontSize="14" GroupName="EngineeringPermitting" Content="Percentage of Capital Cost" 
                                 IsChecked="{Binding EngineeringPermittingOptionsProperty, Mode=TwoWay, Converter={StaticResource RadioButtonCheckedConverter}, ConverterParameter=OptionEstimate}"
                                 IsEnabled="{Binding IsEngineeringPermitting}"/>

                                 <StackPanel Grid.Row="1" Grid.Column="1" Style="{StaticResource MyStackPanel}" >
                                    <Label Style="{StaticResource MyLabelPropertyName}" Content="" />
                                    <Controls:NumericUpDown Style="{StaticResource MyNumericUpDownEngineeringPermittingPercentage}" Minimum="0" Maximum="75" Interval="0.5"
                                                Value="{Binding EngineeringPermittingPercentage, Mode=TwoWay}"
                                                ToolTip="min = 0, max = 75"/>
                                    <Label Style="{StaticResource MyLabelEngineeringPermittingPercentageUnits}" Content="%" />
                                </StackPanel>

                                <RadioButton x:Name="radioButtonEngineeringPermittingUserSpecified" Grid.Row="2" Grid.Column="0" Margin="50,0,0,0" FontSize="14" GroupName="EngineeringPermitting" Content="User-Specified" 
                                 IsChecked="{Binding EngineeringPermittingOptionsProperty, Mode=TwoWay, Converter={StaticResource RadioButtonCheckedConverter}, ConverterParameter=OptionUserSpecified}"
                                 IsEnabled="{Binding IsEngineeringPermitting}"/>

                                <StackPanel Grid.Row="2" Grid.Column="1" Style="{StaticResource MyStackPanel}" >
                                    <Label Style="{StaticResource MyLabelPropertyName}" Content="" />
                                    <Controls:NumericUpDown Style="{StaticResource MyNumericUpDownEngineeringPermittingCostUserSpecified}" Minimum="0" Maximum="1000000" Interval="100" StringFormat="C2"
                                                Value="{Binding EngineeringPermittingCostUserSpecified, Mode=TwoWay}"
                                                ToolTip="min = 0, max = 1,000,000"/>
                                    <Label Style="{StaticResource MyLabelEngineeringPermittingCostUserSpecifiedUnits}" Content="$" />
                                </StackPanel>

                                <CheckBox x:Name="checkBoxSurveying" Grid.Row="3" Grid.Column="0" FontSize="14" Margin="5" Content="Surveying"
                                          IsChecked="{Binding IsSurveying, Mode=TwoWay}"/>

                                <RadioButton x:Name="radioButtonSurveyingEstimate" Grid.Row="4" Grid.Column="0" Margin="50,0,0,0" FontSize="14" GroupName="Surveying" Content="Percentage of Capital Cost" 
                                 IsChecked="{Binding SurveyingOptionsProperty, Mode=TwoWay, Converter={StaticResource RadioButtonCheckedConverter}, ConverterParameter=OptionEstimate}" 
                                 IsEnabled="{Binding IsSurveying}"/>

                                <StackPanel Grid.Row="4" Grid.Column="1" Style="{StaticResource MyStackPanel}" >
                                    <Label Style="{StaticResource MyLabelPropertyName}" Content="" />
                                    <Controls:NumericUpDown Style="{StaticResource MyNumericUpDownSurveyingPercentage}" Minimum="0" Maximum="75" Interval="0.5"
                                                Value="{Binding SurveyingPercentage, Mode=TwoWay}"
                                                ToolTip="min = 0, max = 75"/>
                                    <Label Style="{StaticResource MyLabelSurveyingPercentageUnits}" Content="%" />
                                </StackPanel>

                                <RadioButton x:Name="radioButtonSurveyingUserSpecified" Grid.Row="5" Grid.Column="0" Margin="50,0,0,0" FontSize="14" GroupName="Surveying" Content="User-Specified" 
                                 IsChecked="{Binding SurveyingOptionsProperty, Mode=TwoWay, Converter={StaticResource RadioButtonCheckedConverter}, ConverterParameter=OptionUserSpecified}"
                                 IsEnabled="{Binding IsSurveying}"/>

                                <StackPanel Grid.Row="5" Grid.Column="1" Style="{StaticResource MyStackPanel}" >
                                    <Label Style="{StaticResource MyLabelPropertyName}" Content="" />
                                    <Controls:NumericUpDown Style="{StaticResource MyNumericUpDownSurveyingCostUserSpecified}" Minimum="0" Maximum="1000000" Interval="100" StringFormat="C2"
                                                Value="{Binding SurveyingCostUserSpecified, Mode=TwoWay}"
                                                ToolTip="min = 0, max = 1,000,000"/>
                                    <Label Style="{StaticResource MyLabelSurveyingCostUserSpecifiedUnits}" Content="$" />
                                </StackPanel>

                                <CheckBox x:Name="checkBoxConstructionInspection" Grid.Row="6" Grid.Column="0" FontSize="14" Margin="5" Content="Construction Inspection"
                                          IsChecked="{Binding IsConstructionInspection, Mode=TwoWay}"/>

                                <RadioButton x:Name="radioButtonConstructionInspectionEstimate" Grid.Row="7" Grid.Column="0" Margin="50,0,0,0" FontSize="14" GroupName="ConstructionInspection" Content="Percentage of Capital Cost" 
                                 IsChecked="{Binding ConstructionInspectionOptionsProperty, Mode=TwoWay, Converter={StaticResource RadioButtonCheckedConverter}, ConverterParameter=OptionEstimate}" 
                                 IsEnabled="{Binding IsConstructionInspection}"/>

                                <StackPanel Grid.Row="7" Grid.Column="1" Style="{StaticResource MyStackPanel}" >
                                    <Label Style="{StaticResource MyLabelPropertyName}" Content="" />
                                    <Controls:NumericUpDown Style="{StaticResource MyNumericUpDownConstructionInspectionPercentage}" Minimum="0" Maximum="75" Interval="0.5"
                                                Value="{Binding ConstructionInspectionPercentage, Mode=TwoWay}"
                                                ToolTip="min = 0, max = 75"/>
                                    <Label Style="{StaticResource MyLabelConstructionInspectionPercentageUnits}" Content="%" />
                                </StackPanel>

                                <RadioButton x:Name="radioButtonConstructionInspectionUserSpecified" Grid.Row="8" Grid.Column="0" Margin="50,0,0,0" FontSize="14" GroupName="ConstructionInspection" Content="User-Specified" 
                                 IsChecked="{Binding ConstructionInspectionOptionsProperty, Mode=TwoWay, Converter={StaticResource RadioButtonCheckedConverter}, ConverterParameter=OptionUserSpecified}"
                                 IsEnabled="{Binding IsConstructionInspection}"/>

                                <StackPanel Grid.Row="8" Grid.Column="1" Style="{StaticResource MyStackPanel}" >
                                    <Label Style="{StaticResource MyLabelPropertyName}" Content="" />
                                    <Controls:NumericUpDown Style="{StaticResource MyNumericUpDownConstructionInspectionCostUserSpecified}" Minimum="0" Maximum="1000000" Interval="100" StringFormat="C2"
                                                Value="{Binding ConstructionInspectionCostUserSpecified, Mode=TwoWay}"
                                                ToolTip="min = 0, max = 1,000,000"/>
                                    <Label Style="{StaticResource MyLabelConstructionInspectionCostUserSpecifiedUnits}" Content="$" />
                                </StackPanel>
                            </Grid>

                        </ScrollViewer>
                    </Expander>
                </StackPanel>

                <!-- Other Capital Items -->
                <Grid Style="{StaticResource MyGridHeader}">
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition ></ColumnDefinition>
                        <ColumnDefinition Width=".1*"></ColumnDefinition>
                    </Grid.ColumnDefinitions>

                    <Grid.RowDefinitions>
                        <RowDefinition></RowDefinition>
                    </Grid.RowDefinitions>

                    <StackPanel Grid.Row="0" Grid.Column="0" Orientation="Horizontal">
                        <iconPacks:PackIconModern Kind="AppPlus" Style="{StaticResource MyIconPackModernHeaders}" />
                        <TextBlock Grid.Row="0" Grid.Column="0" Style="{StaticResource MyTextBlockHeader}" Text="Other Capital Items" />
                    </StackPanel>
                    <Button Grid.Row="0" Grid.Column="1" Style="{StaticResource MyButtonSectionInformation}" ToolTip="About Other Capital Items" 
                                Content="{iconPacks:Modern InformationCircle, Width=12, Height=12}"  
                                Command="{Binding ShowMessageDialogCommandOtherItemsCapital}"/>
                    <Separator Grid.Row="0" Grid.ColumnSpan="2" Style="{StaticResource MySeparatorHeader}" />
                </Grid>

                <ScrollViewer Style="{StaticResource MyScrollViewerForEachSection}" HorizontalScrollBarVisibility="Auto" Height="200">
                    <Grid>
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition></ColumnDefinition>
                            <ColumnDefinition></ColumnDefinition>
                        </Grid.ColumnDefinitions>

                        <Grid.RowDefinitions>
                            <RowDefinition></RowDefinition>
                            <RowDefinition></RowDefinition>
                            <RowDefinition></RowDefinition>
                            <RowDefinition></RowDefinition>
                            <RowDefinition></RowDefinition>
                            <RowDefinition></RowDefinition>
                            <RowDefinition></RowDefinition>
                            <RowDefinition></RowDefinition>
                            <RowDefinition></RowDefinition>
                            <RowDefinition></RowDefinition>
                            <RowDefinition></RowDefinition>
                            <RowDefinition></RowDefinition>
                            <RowDefinition></RowDefinition>
                            <RowDefinition></RowDefinition>
                            <RowDefinition></RowDefinition>
                            <RowDefinition></RowDefinition>
                        </Grid.RowDefinitions>

                        <TextBlock Grid.Row="0" Grid.Column="0" Style="{StaticResource MyTextBlockPropertyName}" Text="Item #1 Description" />
                        <TextBox Grid.Row="0" Grid.Column="1" Text="{Binding OtherAnnualItemDescription1, Mode=TwoWay}" Controls:TextBoxHelper.Watermark="Enter a description" Width="400" Height="25" MinWidth="250" MinHeight="25" MaxWidth="400" MaxHeight="25" HorizontalAlignment="Left" Margin="2" FontSize="14" BorderThickness="0,0,0,1"/>

                        <TextBlock Grid.Row="1" Grid.Column="0" Style="{StaticResource MyTextBlockPropertyName}" Text="Item #1 Quantity" />
                        <StackPanel Grid.Row="1" Grid.Column="2" Style="{StaticResource MyStackPanel}" >
                            <Controls:NumericUpDown Style="{StaticResource MyNumericUpDown}" Minimum="0" Maximum="50" Interval="1" 
                                                    Value="{Binding OtherCapitalItemQuantity1, Mode=TwoWay}"
                                                    ToolTip="min = 0, max = 50"/>
                            <TextBlock  Style="{StaticResource MyTextBlockPropertyUnits}" Text="each" />
                        </StackPanel>

                        <TextBlock Grid.Row="2" Grid.Column="0" Style="{StaticResource MyTextBlockPropertyName}" Text="Item #1 Unit Cost" />
                        <StackPanel Grid.Row="2" Grid.Column="2" Style="{StaticResource MyStackPanel}" >
                            <Controls:NumericUpDown Style="{StaticResource MyNumericUpDown}" Minimum="0" Maximum="1000000" Interval="100" StringFormat="C2" 
                                                    Value="{Binding OtherCapitalItemUnitCost1, Mode=TwoWay}"
                                                    ToolTip="min = 0, max = 1,000,000"/>
                            <TextBlock  Style="{StaticResource MyTextBlockPropertyUnits}" Text="$/each" />
                        </StackPanel>

                        <TextBlock Grid.Row="3" Grid.Column="0" Style="{StaticResource MyTextBlockPropertyName}" Text="Item #2 Description" />
                        <TextBox Grid.Row="3" Grid.Column="1" Text="{Binding OtherCapitalItemDescription2, Mode=TwoWay}" Controls:TextBoxHelper.Watermark="Enter a description" Width="400" Height="25" MinWidth="250" MinHeight="25" MaxWidth="400" MaxHeight="25" HorizontalAlignment="Left" Margin="2" FontSize="14" BorderThickness="0,0,0,1"/>

                        <TextBlock Grid.Row="4" Grid.Column="0" Style="{StaticResource MyTextBlockPropertyName}" Text="Item #2 Quantity" />
                        <StackPanel Grid.Row="4" Grid.Column="2" Style="{StaticResource MyStackPanel}" >
                            <Controls:NumericUpDown Style="{StaticResource MyNumericUpDown}" Minimum="0" Maximum="50" Interval="1" 
                                                    Value="{Binding OtherCapitalItemQuantity2, Mode=TwoWay}"
                                                    ToolTip="min = 0, max = 50"/>
                            <TextBlock  Style="{StaticResource MyTextBlockPropertyUnits}" Text="each" />
                        </StackPanel>

                        <TextBlock Grid.Row="5" Grid.Column="0" Style="{StaticResource MyTextBlockPropertyName}" Text="Item #2 Unit Cost" />
                        <StackPanel Grid.Row="5" Grid.Column="2" Style="{StaticResource MyStackPanel}" >
                            <Controls:NumericUpDown Style="{StaticResource MyNumericUpDown}" Minimum="0" Maximum="1000000" Interval="100" StringFormat="C2" 
                                                    Value="{Binding OtherCapitalItemUnitCost2, Mode=TwoWay}"
                                                    ToolTip="min = 0, max = 1,000,000"/>
                            <TextBlock  Style="{StaticResource MyTextBlockPropertyUnits}" Text="$/each" />
                        </StackPanel>

                        <TextBlock Grid.Row="6" Grid.Column="0" Style="{StaticResource MyTextBlockPropertyName}" Text="Item #3 Description" />
                        <TextBox Grid.Row="6" Grid.Column="1" Text="{Binding OtherCapitalItemDescription3, Mode=TwoWay}" Controls:TextBoxHelper.Watermark="Enter a description" Width="400" Height="25" MinWidth="250" MinHeight="25" MaxWidth="400" MaxHeight="25" HorizontalAlignment="Left" Margin="2" FontSize="14" BorderThickness="0,0,0,1"/>

                        <TextBlock Grid.Row="7" Grid.Column="0" Style="{StaticResource MyTextBlockPropertyName}" Text="Item #3 Quantity" />
                        <StackPanel Grid.Row="7" Grid.Column="2" Style="{StaticResource MyStackPanel}" >
                            <Controls:NumericUpDown Style="{StaticResource MyNumericUpDown}" Minimum="0" Maximum="50" Interval="1" 
                                                    Value="{Binding OtherCapitalItemQuantity3, Mode=TwoWay}"
                                                    ToolTip="min = 0, max = 50"/>
                            <TextBlock  Style="{StaticResource MyTextBlockPropertyUnits}" Text="each" />
                        </StackPanel>

                        <TextBlock Grid.Row="8" Grid.Column="0" Style="{StaticResource MyTextBlockPropertyName}" Text="Item #3 Unit Cost" />
                        <StackPanel Grid.Row="8" Grid.Column="2" Style="{StaticResource MyStackPanel}" >
                            <Controls:NumericUpDown Style="{StaticResource MyNumericUpDown}" Minimum="0" Maximum="1000000" Interval="100" StringFormat="C2" 
                                                    Value="{Binding OtherCapitalItemUnitCost3, Mode=TwoWay}"
                                                    ToolTip="min = 0, max = 1,000,000"/>
                            <TextBlock  Style="{StaticResource MyTextBlockPropertyUnits}" Text="$/each" />
                        </StackPanel>

                        <TextBlock Grid.Row="9" Grid.Column="0" Style="{StaticResource MyTextBlockPropertyName}" Text="Item #4 Description" />
                        <TextBox Grid.Row="9" Grid.Column="1" Text="{Binding OtherCapitalItemDescription4, Mode=TwoWay}" Controls:TextBoxHelper.Watermark="Enter a description" Width="400" Height="25" MinWidth="250" MinHeight="25" MaxWidth="400" MaxHeight="25" HorizontalAlignment="Left" Margin="2" FontSize="14" BorderThickness="0,0,0,1"/>

                        <TextBlock Grid.Row="10" Grid.Column="0" Style="{StaticResource MyTextBlockPropertyName}" Text="Item #4 Quantity" />
                        <StackPanel Grid.Row="10" Grid.Column="2" Style="{StaticResource MyStackPanel}" >
                            <Controls:NumericUpDown Style="{StaticResource MyNumericUpDown}" Minimum="0" Maximum="50" Interval="1" 
                                                    Value="{Binding OtherCapitalItemQuantity4, Mode=TwoWay}"
                                                    ToolTip="min = 0, max = 50"/>
                            <TextBlock  Style="{StaticResource MyTextBlockPropertyUnits}" Text="each" />
                        </StackPanel>

                        <TextBlock Grid.Row="11" Grid.Column="0" Style="{StaticResource MyTextBlockPropertyName}" Text="Item #4 Unit Cost" />
                        <StackPanel Grid.Row="11" Grid.Column="2" Style="{StaticResource MyStackPanel}" >
                            <Controls:NumericUpDown Style="{StaticResource MyNumericUpDown}" Minimum="0" Maximum="1000000" Interval="100" StringFormat="C2" 
                                                    Value="{Binding OtherCapitalItemUnitCost4, Mode=TwoWay}"
                                                    ToolTip="min = 0, max = 1,000,000"/>
                            <TextBlock  Style="{StaticResource MyTextBlockPropertyUnits}" Text="$/each" />
                        </StackPanel>

                        <TextBlock Grid.Row="12" Grid.Column="0" Style="{StaticResource MyTextBlockPropertyName}" Text="Item #5 Description" />
                        <TextBox Grid.Row="12" Grid.Column="1" Text="{Binding OtherCapitalItemDescription5, Mode=TwoWay}" Controls:TextBoxHelper.Watermark="Enter a description" Width="400" Height="25" MinWidth="250" MinHeight="25" MaxWidth="400" MaxHeight="25" HorizontalAlignment="Left" Margin="2" FontSize="14" BorderThickness="0,0,0,1"/>

                        <TextBlock Grid.Row="13" Grid.Column="0" Style="{StaticResource MyTextBlockPropertyName}" Text="Item #5 Quantity" />
                        <StackPanel Grid.Row="13" Grid.Column="2" Style="{StaticResource MyStackPanel}" >
                            <Controls:NumericUpDown Style="{StaticResource MyNumericUpDown}" Minimum="0" Maximum="50" Interval="1" 
                                                    Value="{Binding OtherCapitalItemQuantity5, Mode=TwoWay}"
                                                    ToolTip="min = 0, max = 50"/>
                            <TextBlock  Style="{StaticResource MyTextBlockPropertyUnits}" Text="each" />
                        </StackPanel>

                        <TextBlock Grid.Row="14" Grid.Column="0" Style="{StaticResource MyTextBlockPropertyName}" Text="Item #5 Unit Cost" />
                        <StackPanel Grid.Row="14" Grid.Column="2" Style="{StaticResource MyStackPanel}" >
                            <Controls:NumericUpDown Style="{StaticResource MyNumericUpDown}" Minimum="0" Maximum="1000000" Interval="100" StringFormat="C2" 
                                                    Value="{Binding OtherCapitalItemUnitCost5, Mode=TwoWay}"
                                                    ToolTip="min = 0, max = 1,000,000"/>
                            <TextBlock  Style="{StaticResource MyTextBlockPropertyUnits}" Text="$/each" />
                        </StackPanel>

                    </Grid>
                </ScrollViewer>

                <!-- Annual Cost Input -->
                <Grid Style="{StaticResource MyGridHeader}">
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition ></ColumnDefinition>
                        <ColumnDefinition Width=".1*"></ColumnDefinition>
                    </Grid.ColumnDefinitions>

                    <Grid.RowDefinitions>
                        <RowDefinition></RowDefinition>
                    </Grid.RowDefinitions>

                    <StackPanel Grid.Row="0" Grid.Column="0" Orientation="Horizontal">
                        <iconPacks:PackIconModern Kind="AppPlus" Style="{StaticResource MyIconPackModernHeaders}" />
                        <TextBlock Grid.Row="0" Grid.Column="0" Style="{StaticResource MyTextBlockHeader}" Text="Annual Cost Input" />
                    </StackPanel>
                    <Button Grid.Row="0" Grid.Column="1" Style="{StaticResource MyButtonSectionInformation}" ToolTip="About Annual Cost Input" 
                                Content="{iconPacks:Modern InformationCircle, Width=12, Height=12}"  
                                Command="{Binding ShowMessageDialogCommandAnnualCostInput}"/>
                    <Separator Grid.Row="0" Grid.ColumnSpan="2" Style="{StaticResource MySeparatorHeader}" />
                </Grid>

                <Grid>
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition ></ColumnDefinition>
                        <ColumnDefinition ></ColumnDefinition>
                    </Grid.ColumnDefinitions>

                    <Grid.RowDefinitions>
                        <RowDefinition></RowDefinition>
                        <RowDefinition></RowDefinition>
                        <RowDefinition></RowDefinition>
                        <RowDefinition></RowDefinition>
                        <RowDefinition></RowDefinition>
                        <RowDefinition></RowDefinition>
                        <RowDefinition></RowDefinition>
                        <RowDefinition></RowDefinition>
                        <RowDefinition></RowDefinition>
                        <RowDefinition></RowDefinition>
                        <RowDefinition></RowDefinition>
                        <RowDefinition></RowDefinition>
                        <RowDefinition></RowDefinition>
                        <RowDefinition></RowDefinition>
                    </Grid.RowDefinitions>

                    <Label Grid.Row="0" Grid.Column="0" Style="{StaticResource MyLabelPropertyName}" Content="Operation" />
                    
                    <Label Grid.Row="1" Grid.Column="0" Style="{StaticResource MyLabelPropertyName}" Margin="50,0,0,0" Content="Property Tax" />
                    <StackPanel Grid.Row="1" Grid.Column="1" Style="{StaticResource MyStackPanel}" >
                        <Controls:NumericUpDown Style="{StaticResource MyNumericUpDown}" Minimum="0" Maximum="100000" Interval="100" StringFormat="C2"
                                                    Value="{Binding AnnualCostPropertyTax, Mode=TwoWay}"
                                                    ToolTip="min = 0, max = 100,000"
                                                    Background="{Binding IsError, Converter={StaticResource BoolToBrushBackground}}" />
                        <Label Style="{StaticResource MyLabelPropertyUnits}" Content="$"/>
                    </StackPanel>

                    <Label Grid.Row="2" Grid.Column="0" Style="{StaticResource MyLabelPropertyName}" Margin="50,0,0,0" Content="Utility" />
                    <StackPanel Grid.Row="2" Grid.Column="1" Style="{StaticResource MyStackPanel}" >
                        <Controls:NumericUpDown Style="{StaticResource MyNumericUpDown}" Minimum="0" Maximum="100000" Interval="50" StringFormat="C2"
                                                    Value="{Binding AnnualCostUtility, Mode=TwoWay}"
                                                    ToolTip="min = 0, max = 100,000"
                                                    Background="{Binding IsError, Converter={StaticResource BoolToBrushBackground}}" />
                        <Label Style="{StaticResource MyLabelPropertyUnits}" Content="$/month"/>
                    </StackPanel>

                    <CheckBox x:Name="checkBoxAnnualCostOperationOther" Grid.Row="3" Grid.Column="0" FontSize="14" Margin="50,0,0,0" Content="Other"
                                          IsChecked="{Binding IsAnnualCostOperationOther, Mode=TwoWay}"/>
                    <StackPanel Grid.Row="3" Grid.Column="1" Style="{StaticResource MyStackPanel}" >
                        <Controls:NumericUpDown Style="{StaticResource MyNumericUpDown}" Minimum="0" Maximum="100000" Interval="50" StringFormat="C2"
                                                    Value="{Binding AnnualCostOperationOther, Mode=TwoWay}"
                                                    ToolTip="min = 0, max = 100,000"
                                                    Background="{Binding IsError, Converter={StaticResource BoolToBrushBackground}}" />
                        <Label Style="{StaticResource MyLabelPropertyUnits}" Content="$/month"/>
                    </StackPanel>

                    <Label Grid.Row="4" Grid.Column="0" Style="{StaticResource MyLabelPropertyName}" Content="Maintenance" />

                    <Label Grid.Row="5" Grid.Column="0" Style="{StaticResource MyLabelPropertyName}" Margin="50,0,0,0" Content="Building Maintenance" />
                    <StackPanel Grid.Row="5" Grid.Column="1" Style="{StaticResource MyStackPanel}" >
                        <Controls:NumericUpDown Style="{StaticResource MyNumericUpDown}" Minimum="0" Maximum="500" Interval="1" 
                                                    Value="{Binding BuildingMaintenanceHoursPerYear, Mode=TwoWay}"
                                                    ToolTip="min = 0, max = 500"
                                                    Background="{Binding IsError, Converter={StaticResource BoolToBrushBackground}}" />
                        <Label Style="{StaticResource MyLabelPropertyUnits}" Content="hrs/yr"/>
                    </StackPanel>
                    
                    <Label Grid.Row="6" Grid.Column="0" Style="{StaticResource MyLabelPropertyName}" Margin="50,0,0,0" Content="Parking Maintenance" />
                    <StackPanel Grid.Row="6" Grid.Column="1" Style="{StaticResource MyStackPanel}" >
                        <Controls:NumericUpDown Style="{StaticResource MyNumericUpDown}" Minimum="0" Maximum="100" Interval="0.5" StringFormat="C2"
                                                    Value="{Binding ParkingAreaMaintenanceUnitCost, Mode=TwoWay}"
                                                    ToolTip="min = 0, max = 100"
                                                    Background="{Binding IsError, Converter={StaticResource BoolToBrushBackground}}" />
                        <Label Style="{StaticResource MyLabelPropertyUnits}" >
                            <Run Typography.Variants="Superscript">$/ft&#x00B2;/yr</Run>
                        </Label>
                    </StackPanel>

                    <Label Grid.Row="7" Grid.Column="0" Style="{StaticResource MyLabelPropertyName}" Margin="50,0,0,0" Content="Road Maintenance" />
                    <StackPanel Grid.Row="7" Grid.Column="1" Style="{StaticResource MyStackPanel}" >
                        <Controls:NumericUpDown Style="{StaticResource MyNumericUpDown}" Minimum="0" Maximum="500" Interval="1" 
                                                    Value="{Binding RoadMaintenanceHoursPerYear, Mode=TwoWay}"
                                                    ToolTip="min = 0, max = 500"
                                                    Background="{Binding IsError, Converter={StaticResource BoolToBrushBackground}}" />
                        <Label Style="{StaticResource MyLabelPropertyUnits}" Content="hrs/yr"/>
                    </StackPanel>

                    <Label Grid.Row="8" Grid.Column="0" Style="{StaticResource MyLabelPropertyName}" Margin="50,0,0,0" Content="Mowing" />
                    <StackPanel Grid.Row="8" Grid.Column="1" Style="{StaticResource MyStackPanel}" >
                        <Controls:NumericUpDown Style="{StaticResource MyNumericUpDown}" Minimum="0" Maximum="1000" Interval="1" 
                                                    Value="{Binding MowingHoursPerYear, Mode=TwoWay}"
                                                    ToolTip="min = 0, max = 1,000"
                                                    Background="{Binding IsError, Converter={StaticResource BoolToBrushBackground}}" />
                        <Label Style="{StaticResource MyLabelPropertyUnits}" Content="hrs/yr"/>
                    </StackPanel>

                    <Label Grid.Row="9" Grid.Column="0" Style="{StaticResource MyLabelPropertyName}" Margin="50,0,0,0" Content="Snow Removal" />
                    <StackPanel Grid.Row="9" Grid.Column="1" Style="{StaticResource MyStackPanel}" >
                        <Controls:NumericUpDown Style="{StaticResource MyNumericUpDown}" Minimum="0" Maximum="500" Interval="1" 
                                                    Value="{Binding SnowRemovalHoursPerYear, Mode=TwoWay}"
                                                    ToolTip="min = 0, max = 500"
                                                    Background="{Binding IsError, Converter={StaticResource BoolToBrushBackground}}" />
                        <Label Style="{StaticResource MyLabelPropertyUnits}" Content="hrs/yr"/>
                    </StackPanel>

                    <Label Grid.Row="10" Grid.Column="0" Style="{StaticResource MyLabelPropertyName}" Margin="50,0,0,0" Content="Ditch &amp; Culvert Cleaning" />
                    <StackPanel Grid.Row="10" Grid.Column="1" Style="{StaticResource MyStackPanel}" >
                        <Controls:NumericUpDown Style="{StaticResource MyNumericUpDown}" Minimum="0" Maximum="80" Interval="1" 
                                                    Value="{Binding DitchCulvertCleaningHoursPerYear, Mode=TwoWay}"
                                                    ToolTip="min = 0, max = 80"
                                                    Background="{Binding IsError, Converter={StaticResource BoolToBrushBackground}}" />
                        <Label Style="{StaticResource MyLabelPropertyUnits}" Content="hrs/yr"/>
                    </StackPanel>

                    <Label Grid.Row="11" Grid.Column="0" Style="{StaticResource MyLabelPropertyName}" Margin="50,0,0,0" Content="Leaf Removal" />
                    <StackPanel Grid.Row="11" Grid.Column="1" Style="{StaticResource MyStackPanel}" >
                        <Controls:NumericUpDown Style="{StaticResource MyNumericUpDown}" Minimum="0" Maximum="500" Interval="1" 
                                                    Value="{Binding LeafRemovalHoursPerYear, Mode=TwoWay}"
                                                    ToolTip="min = 0, max = 500"
                                                    Background="{Binding IsError, Converter={StaticResource BoolToBrushBackground}}" />
                        <Label Style="{StaticResource MyLabelPropertyUnits}" Content="hrs/yr"/>
                    </StackPanel>

                    <Label Grid.Row="12" Grid.Column="0" Style="{StaticResource MyLabelPropertyName}" Margin="50,0,0,0" Content="Site Inspections/Monitoring" />
                    <StackPanel Grid.Row="12" Grid.Column="1" Style="{StaticResource MyStackPanel}" >
                        <Controls:NumericUpDown Style="{StaticResource MyNumericUpDown}" Minimum="0" Maximum="500" Interval="1" 
                                                    Value="{Binding SiteInspectionsHoursPerYear, Mode=TwoWay}"
                                                    ToolTip="min = 0, max = 500"
                                                    Background="{Binding IsError, Converter={StaticResource BoolToBrushBackground}}" />
                        <Label Style="{StaticResource MyLabelPropertyUnits}" Content="hrs/yr"/>
                    </StackPanel>

                    <Label Grid.Row="13" Grid.Column="0" Style="{StaticResource MyLabelPropertyName}" Margin="50,0,0,0" Content="Other" />
                    <StackPanel Grid.Row="13" Grid.Column="1" Style="{StaticResource MyStackPanel}" >
                        <Controls:NumericUpDown Style="{StaticResource MyNumericUpDown}" Minimum="0" Maximum="500" Interval="1" 
                                                    Value="{Binding AnnualOtherHoursPerYear, Mode=TwoWay}"
                                                    ToolTip="min = 0, max = 500"
                                                    Background="{Binding IsError, Converter={StaticResource BoolToBrushBackground}}" />
                        <Label Style="{StaticResource MyLabelPropertyUnits}" Content="hrs/yr"/>
                    </StackPanel>
                </Grid>

            </StackPanel>
        </ScrollViewer>

        <ScrollViewer Grid.Column="1" MinHeight="700" CanContentScroll="False" >
            <StackPanel Grid.Column="1" Margin="10">
                <!-- Sizing Summary -->
                <Grid Style="{StaticResource MyGridHeader}" >
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition ></ColumnDefinition>
                        <ColumnDefinition ></ColumnDefinition>
                        <ColumnDefinition Width=".1*"></ColumnDefinition>
                    </Grid.ColumnDefinitions>

                    <Grid.RowDefinitions>
                        <RowDefinition></RowDefinition>
                    </Grid.RowDefinitions>

                    <StackPanel Grid.Row="0" Grid.Column="0" Orientation="Horizontal">
                        <iconPacks:PackIconModern Kind="Paper" Style="{StaticResource MyIconPackModernHeaders}" />
                        <TextBlock Grid.Row="0" Grid.Column="0" Style="{StaticResource MyTextBlockHeader}" Text="Sizing Summary" />
                    </StackPanel>

                    <TextBlock Grid.Row="0" Grid.Column="1" Style="{StaticResource MyTextBlockHeaderValue}" 
                               Text="{Binding CalcLimestoneWeight, Mode=TwoWay, StringFormat={}Limestone Bed:  {0:F2} tons}"
                               TextWrapping="Wrap"
                               Foreground="{Binding IsError, Converter={StaticResource BoolToBrushText}}"
                               Visibility="{Binding IsMajorError, Converter={StaticResource BoolToVisibility}}" 
                               HorizontalAlignment="Right"
                               ToolTip="Weight of Limestone Bed"/>
                    <Button Grid.Row="0" Grid.Column="2" Style="{StaticResource MyButtonSectionInformation}" ToolTip="About Sizing Summary" 
                                Content="{iconPacks:Modern InformationCircle, Width=12, Height=12}"  
                                Command="{Binding ShowMessageDialogCommandSizingSummary}"/>
                    <Separator Grid.Row="0" Grid.ColumnSpan="3" Style="{StaticResource MySeparatorHeader}" Background="{Binding IsError, Converter={StaticResource BoolToBrushSeparater}}" />
                </Grid>


                <ScrollViewer Style="{StaticResource MyScrollViewerForEachSection}" CanContentScroll="True" HorizontalScrollBarVisibility="Auto" Height="350" >
                    <Grid>
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition></ColumnDefinition>
                            <ColumnDefinition></ColumnDefinition>
                        </Grid.ColumnDefinitions>

                        <Grid.RowDefinitions>
                            <RowDefinition></RowDefinition>
                            <RowDefinition></RowDefinition>
                            <RowDefinition></RowDefinition>
                            <RowDefinition></RowDefinition>
                            <RowDefinition></RowDefinition>
                            <RowDefinition></RowDefinition>
                            <RowDefinition></RowDefinition>
                            <RowDefinition></RowDefinition>
                            <RowDefinition></RowDefinition>
                            <RowDefinition></RowDefinition>
                            <RowDefinition></RowDefinition>
                            <RowDefinition></RowDefinition>
                            <RowDefinition></RowDefinition>
                            <RowDefinition></RowDefinition>
                            <RowDefinition></RowDefinition>
                            <RowDefinition></RowDefinition>
                            <RowDefinition></RowDefinition>
                            <RowDefinition></RowDefinition>
                            <RowDefinition></RowDefinition>
                        </Grid.RowDefinitions>

                        <TextBlock Grid.Row="0" Grid.Column="0" Style="{StaticResource MyTextBlockPropertyName}" Text="Access Road Surface Area"/>
                        <StackPanel Grid.Row="0" Grid.Column="1" Style="{StaticResource MyStackPanel}">
                            <TextBlock Style="{StaticResource MyTextBlockAccessRoadSurfaceAreaSquareYardsValue}" Text="{Binding CalcAccessRoadSurfaceAreaSquareYards, Mode=Twoway, StringFormat=F2}"
                                       Foreground="{Binding IsError, Converter={StaticResource BoolToBrushText}}"
                                       Visibility="{Binding IsMajorError, Converter={StaticResource BoolToVisibility}}"/>
                            <TextBlock Style="{StaticResource MyTextBlockAccessRoadSurfaceAreaSquareYardsUnits}">
                                    <Run Typography.Variants="Superscript">yd&#x00B2;</Run>
                            </TextBlock>
                        </StackPanel>
                        <Separator Grid.Row="0" Grid.ColumnSpan="2" Style="{StaticResource MySeparatorSummaries}" />

                        <TextBlock Grid.Row="1" Grid.Column="0" Style="{StaticResource MyTextBlockPropertyName}" Text="Access Road Geotextile Quantity"/>
                        <StackPanel Grid.Row="1" Grid.Column="1" Style="{StaticResource MyStackPanel}">
                            <TextBlock Style="{StaticResource MyTextBlockAccessRoadGeotextileAreaValue}" Text="{Binding CalcAccessRoadGeotextileArea, Mode=Twoway, StringFormat=F2}"
                                       Foreground="{Binding IsError, Converter={StaticResource BoolToBrushText}}"
                                       Visibility="{Binding IsMajorError, Converter={StaticResource BoolToVisibility}}"/>
                            <TextBlock Style="{StaticResource MyTextBlockAccessRoadGeotextileAreaUnits}">
                                    <Run Typography.Variants="Superscript">yd&#x00B2;</Run>
                            </TextBlock>
                        </StackPanel>
                        <Separator Grid.Row="1" Grid.ColumnSpan="2" Style="{StaticResource MySeparatorSummaries}" />

                        <TextBlock Grid.Row="2" Grid.Column="0" Style="{StaticResource MyTextBlockPropertyName}" Text="Access Road Cut and Fill Volume" />
                        <StackPanel Grid.Row="2" Grid.Column="1" Style="{StaticResource MyStackPanel}">
                            <TextBlock Style="{StaticResource MyTextBlockAccessRoadCutFillVolumeCubicYardsValue}" Text="{Binding CalcAccessRoadCutFillVolumeCubicYards, Mode=Twoway, StringFormat=F2}"
                                       Foreground="{Binding IsError, Converter={StaticResource BoolToBrushText}}"
                                       Visibility="{Binding IsMajorError, Converter={StaticResource BoolToVisibility}}"/>
                            <TextBlock Style="{StaticResource MyTextBlockAccessRoadCutFillVolumeCubicYardsUnits}">
                                    <Run Typography.Variants="Superscript">yd&#x00B3;</Run>
                            </TextBlock>
                        </StackPanel>
                        <Separator Grid.Row="2" Grid.ColumnSpan="2" Style="{StaticResource MySeparatorSummaries}" />

                        <TextBlock Grid.Row="3" Grid.Column="0" Style="{StaticResource MyTextBlockPropertyName}" Text="Parking Surface Area" />
                        <StackPanel Grid.Row="3" Grid.Column="1" Style="{StaticResource MyStackPanel}">
                            <TextBlock Style="{StaticResource MyTextBlockParkingSurfaceAreaSquareYardsValue}" Text="{Binding CalcParkingSurfaceAreaSquareYards, Mode=Twoway, StringFormat=F2}"
                                       Foreground="{Binding IsError, Converter={StaticResource BoolToBrushText}}"
                                       Visibility="{Binding IsMajorError, Converter={StaticResource BoolToVisibility}}"/>
                            <TextBlock Style="{StaticResource MyTextBlockParkingSurfaceAreaSquareYardsUnits}">
                                    <Run Typography.Variants="Superscript">yd&#x00B2;</Run>
                            </TextBlock>
                        </StackPanel>
                        <Separator Grid.Row="3" Grid.ColumnSpan="2" Style="{StaticResource MySeparatorSummaries}" />

                        <TextBlock Grid.Row="4" Grid.Column="0" Style="{StaticResource MyTextBlockPropertyName}" Text="Parking Cut and Fill Volume"  />
                        <StackPanel Grid.Row="4" Grid.Column="1" Style="{StaticResource MyStackPanel}">
                            <TextBlock Style="{StaticResource MyTextBlockParkingAreaCutFillVolumeCubicYardsValue}" Text="{Binding CalcParkingAreaCutFillVolumeCubicYards, Mode=Twoway, StringFormat=F2}" 
                                       Foreground="{Binding IsError, Converter={StaticResource BoolToBrushText}}"
                                       Visibility="{Binding IsMajorError, Converter={StaticResource BoolToVisibility}}"/>
                            <TextBlock Style="{StaticResource MyTextBlockParkingAreaCutFillVolumeCubicYardsUnits}">
                                    <Run Typography.Variants="Superscript">yd&#x00B3;</Run>
                            </TextBlock>
                        </StackPanel>
                        <Separator Grid.Row="4" Grid.ColumnSpan="2" Style="{StaticResource MySeparatorSummaries}" />

                        <TextBlock Grid.Row="5" Grid.Column="0" Style="{StaticResource MyTextBlockPropertyName}" Text="Clear and Grub Area - Site Development" />
                        <StackPanel Grid.Row="5" Grid.Column="1" Style="{StaticResource MyStackPanel}">
                            <TextBlock Style="{StaticResource MyTextBlockPropertyValue}" Text="{Binding CalcClearAndGrubArea, Mode=Twoway, StringFormat=F2}" 
                                       Foreground="{Binding IsError, Converter={StaticResource BoolToBrushText}}"
                                       Visibility="{Binding IsMajorError, Converter={StaticResource BoolToVisibility}}"/>
                            <TextBlock Style="{StaticResource MyTextBlockPropertyUnits}" Text="acres" />
                        </StackPanel>
                        <Separator Grid.Row="5" Grid.ColumnSpan="2" Style="{StaticResource MySeparatorSummaries}" />

                        <TextBlock Grid.Row="6" Grid.Column="0" Style="{StaticResource MyTextBlockPropertyName}" Text="Clear and Grub Area - All Other User Selected Modules" Width="400" />
                        <StackPanel Grid.Row="6" Grid.Column="1" Style="{StaticResource MyStackPanel}">
                            <TextBlock Style="{StaticResource MyTextBlockPropertyValue}" Text="{Binding CalcClearAndGrubAreaPassiveModules, Mode=Twoway, StringFormat=F2}"
                                       Foreground="{Binding IsError, Converter={StaticResource BoolToBrushText}}"
                                       Visibility="{Binding IsMajorError, Converter={StaticResource BoolToVisibility}}"/>
                            <TextBlock Style="{StaticResource MyTextBlockPropertyUnits}" Text="acres" />
                        </StackPanel>
                        <Separator Grid.Row="6" Grid.ColumnSpan="2" Style="{StaticResource MySeparatorSummaries}" />

                        <TextBlock Grid.Row="7" Grid.Column="0" Style="{StaticResource MyTextBlockPropertyName}" Text="Clear and Grub Area - Project Site" />
                        <StackPanel Grid.Row="7" Grid.Column="1" Style="{StaticResource MyStackPanel}">
                            <TextBlock Style="{StaticResource MyTextBlockPropertyValue}" Text="{Binding CalcClearAndGrubAreaTotal, Mode=Twoway, StringFormat=F2}"
                                       Foreground="{Binding IsError, Converter={StaticResource BoolToBrushText}}"
                                       Visibility="{Binding IsMajorError, Converter={StaticResource BoolToVisibility}}"/>
                            <TextBlock Style="{StaticResource MyTextBlockPropertyUnits}" Text="acres" />
                        </StackPanel>
                        <Separator Grid.Row="7" Grid.ColumnSpan="2" Style="{StaticResource MySeparatorSummaries}" />
                        
                        <TextBlock Grid.Row="8" Grid.Column="0" Style="{StaticResource MyTextBlockPropertyName}" Text="Rock Lined Ditch Aggregate Volume" />
                        <StackPanel Grid.Row="8" Grid.Column="1" Style="{StaticResource MyStackPanel}">
                            <TextBlock Style="{StaticResource MyTextBlockRockLinedDitchVolumeValue}" Text="{Binding CalcRockLinedDitchVolume, Mode=Twoway, StringFormat=F2}" 
                                       Foreground="{Binding IsError, Converter={StaticResource BoolToBrushText}}"
                                       Visibility="{Binding IsMajorError, Converter={StaticResource BoolToVisibility}}"/>
                            <TextBlock Style="{StaticResource MyTextBlockRockLinedDitchVolumeUnits}">
                                    <Run Typography.Variants="Superscript">yd&#x00B3;</Run>
                            </TextBlock>
                        </StackPanel>
                        <Separator Grid.Row="8" Grid.ColumnSpan="2" Style="{StaticResource MySeparatorSummaries}" />

                        <TextBlock Grid.Row="9" Grid.Column="0" Style="{StaticResource MyTextBlockPropertyName}" Text="Rock Lined Ditch Aggregate Weight" />
                        <StackPanel Grid.Row="9" Grid.Column="1" Style="{StaticResource MyStackPanel}">
                            <TextBlock Style="{StaticResource MyTextBlockRockLinedDitchWeightValue}" Text="{Binding CalcRockLinedDitchWeight, Mode=Twoway, StringFormat=F2}"
                                       Foreground="{Binding IsError, Converter={StaticResource BoolToBrushText}}"
                                       Visibility="{Binding IsMajorError, Converter={StaticResource BoolToVisibility}}"/>
                            <TextBlock Style="{StaticResource MyTextBlockRockLinedDitchWeightUnits}" Text="tons" />
                        </StackPanel>
                        <Separator Grid.Row="9" Grid.ColumnSpan="2" Style="{StaticResource MySeparatorSummaries}" />

                        <TextBlock Grid.Row="10" Grid.Column="0" Style="{StaticResource MyTextBlockPropertyName}" Text="Rock Lined Ditch Geotextile Quantity" />
                        <StackPanel Grid.Row="10" Grid.Column="1" Style="{StaticResource MyStackPanel}">
                            <TextBlock Style="{StaticResource MyTextBlockRockLinedDitchGeotextileQuantityValue}" Text="{Binding CalcRockLinedDitchGeotextileQuantity, Mode=Twoway, StringFormat=F2}"
                                       Foreground="{Binding IsError, Converter={StaticResource BoolToBrushText}}"
                                       Visibility="{Binding IsMajorError, Converter={StaticResource BoolToVisibility}}"/>
                            <TextBlock Style="{StaticResource MyTextBlockRockLinedDitchGeotextileQuantityUnits}">
                                    <Run Typography.Variants="Superscript">yd&#x00B2;</Run>
                            </TextBlock>
                        </StackPanel>
                        <Separator Grid.Row="10" Grid.ColumnSpan="2" Style="{StaticResource MySeparatorSummaries}" />

                        <TextBlock Grid.Row="11" Grid.Column="0" Style="{StaticResource MyTextBlockPropertyName}" Text="Control Building Surface Area" />
                        <StackPanel Grid.Row="11" Grid.Column="1" Style="{StaticResource MyStackPanel}">
                            <TextBlock Style="{StaticResource MyTextBlockControlBuildingAreaValue}" Text="{Binding CalcControlBuildingArea, Mode=Twoway, StringFormat=F2}"
                                       Foreground="{Binding IsError, Converter={StaticResource BoolToBrushText}}"
                                       Visibility="{Binding IsMajorError, Converter={StaticResource BoolToVisibility}}"/>
                            <TextBlock Style="{StaticResource MyTextBlockControlBuildingAreaUnits}">
                                    <Run Typography.Variants="Superscript">ft&#x00B2;</Run>
                            </TextBlock>
                        </StackPanel>
                        <Separator Grid.Row="11" Grid.ColumnSpan="2" Style="{StaticResource MySeparatorSummaries}" />

                        <TextBlock Grid.Row="12" Grid.Column="0" Style="{StaticResource MyTextBlockPropertyName}" Text="Overexcavation Depth Based on Soil Condition" />
                        <StackPanel Grid.Row="12" Grid.Column="1" Style="{StaticResource MyStackPanel}">
                            <TextBlock Style="{StaticResource MyTextBlockPropertyValue}" Text="{Binding FoundationSiteSoilFactor, Mode=Twoway, StringFormat=F2}"
                                       Foreground="{Binding IsError, Converter={StaticResource BoolToBrushText}}"
                                       Visibility="{Binding IsMajorError, Converter={StaticResource BoolToVisibility}}"/>
                            <TextBlock Style="{StaticResource MyTextBlockPropertyUnits}" Text="ft"/>
                        </StackPanel>
                        <Separator Grid.Row="12" Grid.ColumnSpan="2" Style="{StaticResource MySeparatorSummaries}" />

                        <TextBlock Grid.Row="13" Grid.Column="0" Style="{StaticResource MyTextBlockPropertyName}" Text="Control Building Foundation/Slab Volume" />
                        <StackPanel Grid.Row="13" Grid.Column="1" Style="{StaticResource MyStackPanel}">
                            <TextBlock Style="{StaticResource MyTextBlockPropertyValue}" Text="{Binding CalcFoundationSlabVolume, Mode=Twoway, StringFormat=F2}"
                                       Foreground="{Binding IsError, Converter={StaticResource BoolToBrushText}}"
                                       Visibility="{Binding IsMajorError, Converter={StaticResource BoolToVisibility}}"/>
                            <TextBlock Style="{StaticResource MyTextBlockPropertyUnits}">
                                    <Run Typography.Variants="Superscript">yd&#x00B3;</Run>
                            </TextBlock>
                        </StackPanel>
                        <Separator Grid.Row="13" Grid.ColumnSpan="2" Style="{StaticResource MySeparatorSummaries}" />

                        <TextBlock Grid.Row="14" Grid.Column="0" Style="{StaticResource MyTextBlockPropertyName}" Text="Foundation Excavation Volume - Project Site" />
                        <StackPanel Grid.Row="14" Grid.Column="1" Style="{StaticResource MyStackPanel}">
                            <TextBlock Style="{StaticResource MyTextBlockPropertyValue}" Text="{Binding CalcFoundationExcavationVolumeTotal, Mode=Twoway, StringFormat=F2}"
                                       Foreground="{Binding IsError, Converter={StaticResource BoolToBrushText}}"
                                       Visibility="{Binding IsMajorError, Converter={StaticResource BoolToVisibility}}"/>
                            <TextBlock Style="{StaticResource MyTextBlockPropertyUnits}">
                                    <Run Typography.Variants="Superscript">yd&#x00B3;</Run>
                            </TextBlock>
                        </StackPanel>
                        <Separator Grid.Row="14" Grid.ColumnSpan="2" Style="{StaticResource MySeparatorSummaries}" />

                        <TextBlock Grid.Row="15" Grid.Column="0" Style="{StaticResource MyTextBlockPropertyName}" Text="Foundation Overexcavation Volume - Project Site" />
                        <StackPanel Grid.Row="15" Grid.Column="1" Style="{StaticResource MyStackPanel}">
                            <TextBlock Style="{StaticResource MyTextBlockPropertyValue}" Text="{Binding CalcFoundationOverExcavationVolumeTotal, Mode=Twoway, StringFormat=F2}"
                                       Foreground="{Binding IsError, Converter={StaticResource BoolToBrushText}}"
                                       Visibility="{Binding IsMajorError, Converter={StaticResource BoolToVisibility}}"/>
                            <TextBlock Style="{StaticResource MyTextBlockPropertyUnits}">
                                    <Run Typography.Variants="Superscript">yd&#x00B3;</Run>
                            </TextBlock>
                        </StackPanel>
                        <Separator Grid.Row="15" Grid.ColumnSpan="2" Style="{StaticResource MySeparatorSummaries}" />

                        <TextBlock Grid.Row="16" Grid.Column="0" Style="{StaticResource MyTextBlockPropertyName}" Text="Fencing Quantity" />
                        <StackPanel Grid.Row="16" Grid.Column="1" Style="{StaticResource MyStackPanel}">
                            <TextBlock Style="{StaticResource MyTextBlockPropertyValue}" Text="{Binding CalcFencingQuantity, Mode=Twoway, StringFormat=F2}"
                                       Foreground="{Binding IsError, Converter={StaticResource BoolToBrushText}}"
                                       Visibility="{Binding IsMajorError, Converter={StaticResource BoolToVisibility}}"/>
                            <TextBlock Style="{StaticResource MyTextBlockPropertyUnits}" Text="ft" />
                        </StackPanel>
                        <Separator Grid.Row="16" Grid.ColumnSpan="2" Style="{StaticResource MySeparatorSummaries}" />

                        <TextBlock Grid.Row="17" Grid.Column="0" Style="{StaticResource MyTextBlockPropertyName}" Text="Foundation Area - All Other User Selected Modules" />
                        <StackPanel Grid.Row="17" Grid.Column="1" Style="{StaticResource MyStackPanel}">
                            <TextBlock Style="{StaticResource MyTextBlockPropertyValue}" Text="{Binding CalcFoundationAreaPassiveAndActiveModules, Mode=Twoway, StringFormat=F2}"
                                       Foreground="{Binding IsError, Converter={StaticResource BoolToBrushText}}"
                                       Visibility="{Binding IsMajorError, Converter={StaticResource BoolToVisibility}}"/>
                            <TextBlock Style="{StaticResource MyTextBlockControlBuildingAreaUnits}">
                                    <Run Typography.Variants="Superscript">ft&#x00B2;</Run>
                            </TextBlock>
                        </StackPanel>
                        <Separator Grid.Row="17" Grid.ColumnSpan="2" Style="{StaticResource MySeparatorSummaries}" />

                        <TextBlock Grid.Row="18" Grid.Column="0" Style="{StaticResource MyTextBlockPropertyName}" Text="Foundation Area x Depth - All Other User Selected Modules" />
                        <StackPanel Grid.Row="18" Grid.Column="1" Style="{StaticResource MyStackPanel}">
                            <TextBlock Style="{StaticResource MyTextBlockPropertyValue}" Text="{Binding CalcFoundationAreaTimesDepthPassiveAndActiveModules, Mode=Twoway, StringFormat=F2}"
                                       Foreground="{Binding IsError, Converter={StaticResource BoolToBrushText}}"
                                       Visibility="{Binding IsMajorError, Converter={StaticResource BoolToVisibility}}"/>
                            <TextBlock Style="{StaticResource MyTextBlockControlBuildingAreaUnits}">
                                    <Run Typography.Variants="Superscript">ft&#x00B3;</Run>
                            </TextBlock>
                        </StackPanel>
                        <Separator Grid.Row="18" Grid.ColumnSpan="2" Style="{StaticResource MySeparatorSummaries}" />
                    </Grid>

                </ScrollViewer>

                <!-- Capital Cost Summary -->
                <Grid Style="{StaticResource MyGridHeader}">
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition ></ColumnDefinition>
                        <ColumnDefinition ></ColumnDefinition>
                        <ColumnDefinition Width=".1*"></ColumnDefinition>
                    </Grid.ColumnDefinitions>

                    <Grid.RowDefinitions>
                        <RowDefinition></RowDefinition>
                    </Grid.RowDefinitions>

                    <StackPanel Grid.Row="0" Grid.Column="0" Orientation="Horizontal">
                        <iconPacks:PackIconModern Kind="CurrencyDollar" Style="{StaticResource MyIconPackModernHeadersCost}" />
                        <TextBlock Grid.Row="0" Grid.Column="0" Style="{StaticResource MyTextBlockHeader}" Text="Capital Cost" />
                    </StackPanel>
                    <TextBlock Grid.Row="0" Grid.Column="1" Style="{StaticResource MyTextBlockHeaderValue}" Text="{Binding CalcCapitalCostTotal, Mode=TwoWay, StringFormat=C2}" 
                               Foreground="{Binding IsError, Converter={StaticResource BoolToBrushText}}"
                               Visibility="{Binding IsMajorError, Converter={StaticResource BoolToVisibility}}" 
                               HorizontalAlignment="Right"
                               ToolTip="Total Capital Cost"/>
                    <Button Grid.Row="0" Grid.Column="2" Style="{StaticResource MyButtonSectionInformation}" ToolTip="About Capital Cost" 
                                Content="{iconPacks:Modern InformationCircle, Width=12, Height=12}"  
                                Command="{Binding ShowMessageDialogCommandCapitalCost}"/>
                    <Separator Grid.Row="0" Grid.ColumnSpan="3" Style="{StaticResource MySeparatorHeader}" Background="{Binding IsError, Converter={StaticResource BoolToBrushSeparater}}" />
                </Grid>

                <ScrollViewer Style="{StaticResource MyScrollViewerForEachSection}" HorizontalScrollBarVisibility="Auto" Height="350" >
                    <Grid>
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition></ColumnDefinition>
                            <ColumnDefinition></ColumnDefinition>
                        </Grid.ColumnDefinitions>

                        <Grid.RowDefinitions>
                            <RowDefinition></RowDefinition>
                            <RowDefinition></RowDefinition>
                            <RowDefinition></RowDefinition>
                            <RowDefinition></RowDefinition>
                            <RowDefinition></RowDefinition>
                            <RowDefinition></RowDefinition>
                            <RowDefinition></RowDefinition>
                            <RowDefinition></RowDefinition>
                            <RowDefinition></RowDefinition>
                            <RowDefinition></RowDefinition>
                            <RowDefinition></RowDefinition>
                            <RowDefinition></RowDefinition>
                            <RowDefinition></RowDefinition>
                            <RowDefinition></RowDefinition>
                            <RowDefinition></RowDefinition>
                            <RowDefinition></RowDefinition>
                            <RowDefinition></RowDefinition>
                            <RowDefinition></RowDefinition>
                            <RowDefinition></RowDefinition>
                            <RowDefinition></RowDefinition>
                            <RowDefinition></RowDefinition>
                            <RowDefinition></RowDefinition>
                            <RowDefinition></RowDefinition>
                            <RowDefinition></RowDefinition>
                            <RowDefinition></RowDefinition>
                            <RowDefinition></RowDefinition>
                            <RowDefinition></RowDefinition>
                        </Grid.RowDefinitions>

                        <Grid.Resources>
                            <converters:RadioButtonCheckedConverter x:Key="RadioButtonCheckedConverter" />
                        </Grid.Resources>

                        <TextBlock Grid.Row="0" Grid.Column="0" Style="{StaticResource MyTextBlockPropertyName}" Text="Mobilization/Demobilization"/>
                        <StackPanel Grid.Row="0" Grid.Column="2" Style="{StaticResource MyStackPanel}" >
                            <TextBlock Style="{StaticResource MyTextBlockPropertyValueCosts}" Text="{Binding CalcMobilizationDemobilizationCost, Mode=TwoWay, StringFormat=C2}"
                                       Foreground="{Binding IsError, Converter={StaticResource BoolToBrushText}}"
                                       Visibility="{Binding IsMajorError, Converter={StaticResource BoolToVisibility}}" />
                        </StackPanel>
                        <Separator Grid.Row="0" Grid.ColumnSpan="2" Style="{StaticResource MySeparatorSummaries}" />

                        <TextBlock Grid.Row="1" Grid.Column="0" Style="{StaticResource MyTextBlockPropertyName}" Text="Property - Purchased"/>
                        <StackPanel Grid.Row="1" Grid.Column="2" Style="{StaticResource MyStackPanel}" >
                            <TextBlock Style="{StaticResource MyTextBlockPropertyValueCosts}" Text="{Binding CalcLandPurchaseCost, Mode=TwoWay, StringFormat=C2}"
                                       Foreground="{Binding IsError, Converter={StaticResource BoolToBrushText}}"
                                       Visibility="{Binding IsMajorError, Converter={StaticResource BoolToVisibility}}"/>
                        </StackPanel>
                        <Separator Grid.Row="1" Grid.ColumnSpan="2" Style="{StaticResource MySeparatorSummaries}" />

                        <TextBlock Grid.Row="2" Grid.Column="0" Style="{StaticResource MyTextBlockPropertyName}" Text="Construction Office Trailer" />
                        <StackPanel Grid.Row="2" Grid.Column="2" Style="{StaticResource MyStackPanel}" >
                            <TextBlock Style="{StaticResource MyTextBlockPropertyValueCosts}" Text="{Binding CalcConstructionOfficeTrailerCost, Mode=TwoWay, StringFormat=C2}"
                                       Foreground="{Binding IsError, Converter={StaticResource BoolToBrushText}}"
                                       Visibility="{Binding IsMajorError, Converter={StaticResource BoolToVisibility}}"/>
                        </StackPanel>
                        <Separator Grid.Row="2" Grid.ColumnSpan="2" Style="{StaticResource MySeparatorSummaries}" />

                        <TextBlock Grid.Row="3" Grid.Column="0" Style="{StaticResource MyTextBlockPropertyName}" Text="Access Road(s)" />
                        <StackPanel Grid.Row="3" Grid.Column="2" Style="{StaticResource MyStackPanel}" >
                            <TextBlock Style="{StaticResource MyTextBlockPropertyValueCosts}" Text="{Binding CalcAccessRoadCost, Mode=TwoWay, StringFormat=C2}"
                                       Foreground="{Binding IsError, Converter={StaticResource BoolToBrushText}}"
                                       Visibility="{Binding IsMajorError, Converter={StaticResource BoolToVisibility}}"/>
                        </StackPanel>
                        <Separator Grid.Row="3" Grid.ColumnSpan="2" Style="{StaticResource MySeparatorSummaries}" />

                        <TextBlock Grid.Row="4" Grid.Column="0" Style="{StaticResource MyTextBlockPropertyName}" Text="Parking Area" />
                        <StackPanel Grid.Row="4" Grid.Column="2" Style="{StaticResource MyStackPanel}" >
                            <TextBlock Style="{StaticResource MyTextBlockPropertyValueCosts}" Text="{Binding CalcParkingAreaCost, Mode=TwoWay, StringFormat=C2}"
                                       Foreground="{Binding IsError, Converter={StaticResource BoolToBrushText}}"
                                       Visibility="{Binding IsMajorError, Converter={StaticResource BoolToVisibility}}"/>
                        </StackPanel>
                        <Separator Grid.Row="4" Grid.ColumnSpan="2" Style="{StaticResource MySeparatorSummaries}" />

                        <TextBlock Grid.Row="5" Grid.Column="0" Style="{StaticResource MyTextBlockPropertyName}" Text="Cut and Fill" />
                        <StackPanel Grid.Row="5" Grid.Column="2" Style="{StaticResource MyStackPanel}" >
                            <TextBlock Style="{StaticResource MyTextBlockPropertyValueCosts}" Text="{Binding CalcCutFillCost, Mode=TwoWay, StringFormat=C2}"
                                       Foreground="{Binding IsError, Converter={StaticResource BoolToBrushText}}"
                                       Visibility="{Binding IsMajorError, Converter={StaticResource BoolToVisibility}}"/>
                        </StackPanel>
                        <Separator Grid.Row="5" Grid.ColumnSpan="2" Style="{StaticResource MySeparatorSummaries}" />

                        <TextBlock Grid.Row="6" Grid.Column="0" Style="{StaticResource MyTextBlockPropertyName}" Text="E&amp;S Control Cost" />
                        <StackPanel Grid.Row="6" Grid.Column="2" Style="{StaticResource MyStackPanel}" >
                            <TextBlock Style="{StaticResource MyTextBlockPropertyValueCosts}" Text="{Binding CalcESControlCost, Mode=TwoWay, StringFormat=C2}"
                                       Foreground="{Binding IsError, Converter={StaticResource BoolToBrushText}}"
                                       Visibility="{Binding IsMajorError, Converter={StaticResource BoolToVisibility}}"/>
                        </StackPanel>
                        <Separator Grid.Row="6" Grid.ColumnSpan="2" Style="{StaticResource MySeparatorSummaries}" />

                        <TextBlock Grid.Row="7" Grid.Column="0" Style="{StaticResource MyTextBlockPropertyName}" Text="Ditches and Culverts"/>
                        <StackPanel Grid.Row="7" Grid.Column="2" Style="{StaticResource MyStackPanel}" >
                            <TextBlock Style="{StaticResource MyTextBlockPropertyValueCosts}" Text="{Binding CalcDitchAndCulvertCost, Mode=TwoWay, StringFormat=C2}"
                                       Foreground="{Binding IsError, Converter={StaticResource BoolToBrushText}}"
                                       Visibility="{Binding IsMajorError, Converter={StaticResource BoolToVisibility}}"/>
                        </StackPanel>
                        <Separator Grid.Row="7" Grid.ColumnSpan="2" Style="{StaticResource MySeparatorSummaries}" />

                        <TextBlock Grid.Row="8" Grid.Column="0" Style="{StaticResource MyTextBlockPropertyName}" Text="Foundation Excavation"/>
                        <StackPanel Grid.Row="8" Grid.Column="2" Style="{StaticResource MyStackPanel}" >
                            <TextBlock Style="{StaticResource MyTextBlockPropertyValueCosts}" Text="{Binding CalcFoundationExcavationCost, Mode=TwoWay, StringFormat=C2}"
                                       Foreground="{Binding IsError, Converter={StaticResource BoolToBrushText}}"
                                       Visibility="{Binding IsMajorError, Converter={StaticResource BoolToVisibility}}"/>
                        </StackPanel>
                        <Separator Grid.Row="8" Grid.ColumnSpan="2" Style="{StaticResource MySeparatorSummaries}" />

                        <TextBlock Grid.Row="9" Grid.Column="0" Style="{StaticResource MyTextBlockPropertyName}" Text="Foundation Overexcavation"/>
                        <StackPanel Grid.Row="9" Grid.Column="2" Style="{StaticResource MyStackPanel}" >
                            <TextBlock Style="{StaticResource MyTextBlockPropertyValueCosts}" Text="{Binding CalcFoundationOverExcavationCost, Mode=TwoWay, StringFormat=C2}"
                                       Foreground="{Binding IsError, Converter={StaticResource BoolToBrushText}}"
                                       Visibility="{Binding IsMajorError, Converter={StaticResource BoolToVisibility}}"/>
                        </StackPanel>
                        <Separator Grid.Row="9" Grid.ColumnSpan="2" Style="{StaticResource MySeparatorSummaries}" />

                        <TextBlock Grid.Row="10" Grid.Column="0" Style="{StaticResource MyTextBlockPropertyName}" Text="Foundation Improvement Excavation"/>
                        <StackPanel Grid.Row="10" Grid.Column="2" Style="{StaticResource MyStackPanel}" >
                            <TextBlock Style="{StaticResource MyTextBlockPropertyValueCosts}" Text="{Binding CalcFoundationImprovementCost, Mode=TwoWay, StringFormat=C2}"
                                       Foreground="{Binding IsError, Converter={StaticResource BoolToBrushText}}"
                                       Visibility="{Binding IsMajorError, Converter={StaticResource BoolToVisibility}}"/>
                        </StackPanel>
                        <Separator Grid.Row="10" Grid.ColumnSpan="2" Style="{StaticResource MySeparatorSummaries}" />

                        <TextBlock Grid.Row="11" Grid.Column="0" Style="{StaticResource MyTextBlockPropertyName}" Text="Control Building"/>
                        <StackPanel Grid.Row="11" Grid.Column="2" Style="{StaticResource MyStackPanel}" >
                            <TextBlock Style="{StaticResource MyTextBlockPropertyValueCosts}" Text="{Binding CalcControlBuildingCostTotal, Mode=TwoWay, StringFormat=C2}"
                                       Foreground="{Binding IsError, Converter={StaticResource BoolToBrushText}}"
                                       Visibility="{Binding IsMajorError, Converter={StaticResource BoolToVisibility}}"/>
                        </StackPanel>
                        <Separator Grid.Row="11" Grid.ColumnSpan="2" Style="{StaticResource MySeparatorSummaries}" />

                        <TextBlock Grid.Row="12" Grid.Column="0" Style="{StaticResource MyTextBlockPropertyName}" Text="Fencing"/>
                        <StackPanel Grid.Row="12" Grid.Column="2" Style="{StaticResource MyStackPanel}" >
                            <TextBlock Style="{StaticResource MyTextBlockPropertyValueCosts}" Text="{Binding CalcFencingCost, Mode=TwoWay, StringFormat=C2}"
                                       Foreground="{Binding IsError, Converter={StaticResource BoolToBrushText}}"
                                       Visibility="{Binding IsMajorError, Converter={StaticResource BoolToVisibility}}"/>
                        </StackPanel>
                        <Separator Grid.Row="12" Grid.ColumnSpan="2" Style="{StaticResource MySeparatorSummaries}" />

                        <TextBlock Grid.Row="13" Grid.Column="0" Style="{StaticResource MyTextBlockPropertyName}" Text="Electric Service/Utility"/>
                        <StackPanel Grid.Row="13" Grid.Column="2" Style="{StaticResource MyStackPanel}" >
                            <TextBlock Style="{StaticResource MyTextBlockPropertyValueCosts}" Text="{Binding CalcElectricUtilityCostTotal, Mode=TwoWay, StringFormat=C2}"
                                       Foreground="{Binding IsError, Converter={StaticResource BoolToBrushText}}"
                                       Visibility="{Binding IsMajorError, Converter={StaticResource BoolToVisibility}}"/>
                        </StackPanel>
                        <Separator Grid.Row="13" Grid.ColumnSpan="2" Style="{StaticResource MySeparatorSummaries}" />

                        <TextBlock Grid.Row="14" Grid.Column="0" Style="{StaticResource MyTextBlockPropertyName}" Text="Access Gates"/>
                        <StackPanel Grid.Row="14" Grid.Column="2" Style="{StaticResource MyStackPanel}" >
                            <TextBlock Style="{StaticResource MyTextBlockPropertyValueCosts}" Text="{Binding CalcAccessGateCost, Mode=TwoWay, StringFormat=C2}"
                                       Foreground="{Binding IsError, Converter={StaticResource BoolToBrushText}}"
                                       Visibility="{Binding IsMajorError, Converter={StaticResource BoolToVisibility}}"/>
                        </StackPanel>
                        <Separator Grid.Row="14" Grid.ColumnSpan="2" Style="{StaticResource MySeparatorSummaries}" />

                        <TextBlock Grid.Row="15" Grid.Column="0" Style="{StaticResource MyTextBlockPropertyName}" Text="Clear and Grub - Project Site"/>
                        <StackPanel Grid.Row="15" Grid.Column="2" Style="{StaticResource MyStackPanel}" >
                            <TextBlock Style="{StaticResource MyTextBlockPropertyValueCosts}" Text="{Binding CalcClearAndGrubCostTotal, Mode=TwoWay, StringFormat=C2}"
                                       Foreground="{Binding IsError, Converter={StaticResource BoolToBrushText}}"
                                       Visibility="{Binding IsMajorError, Converter={StaticResource BoolToVisibility}}"/>
                        </StackPanel>
                        <Separator Grid.Row="15" Grid.ColumnSpan="2" Style="{StaticResource MySeparatorSummaries}" />

                        <TextBlock Grid.Row="16" Grid.Column="0" Style="{StaticResource MyTextBlockPropertyName}" Text="Revegetation"/>
                        <StackPanel Grid.Row="16" Grid.Column="2" Style="{StaticResource MyStackPanel}" >
                            <TextBlock Style="{StaticResource MyTextBlockPropertyValueCosts}" Text="{Binding CalcRevegetationCostTotal, Mode=TwoWay, StringFormat=C2}"
                                       Foreground="{Binding IsError, Converter={StaticResource BoolToBrushText}}"
                                       Visibility="{Binding IsMajorError, Converter={StaticResource BoolToVisibility}}"/>
                        </StackPanel>
                        <Separator Grid.Row="16" Grid.ColumnSpan="2" Style="{StaticResource MySeparatorSummaries}" />

                        <TextBlock Grid.Row="17" Grid.Column="0" Style="{StaticResource MyTextBlockPropertyName}" Text="Engineering/Permitting"/>
                        <StackPanel Grid.Row="17" Grid.Column="2" Style="{StaticResource MyStackPanel}" >
                            <TextBlock Style="{StaticResource MyTextBlockPropertyValueCosts}" Text="{Binding CalcEngineeringPermittingCost, Mode=TwoWay, StringFormat=C2}"
                                       Foreground="{Binding IsError, Converter={StaticResource BoolToBrushText}}"
                                       Visibility="{Binding IsMajorError, Converter={StaticResource BoolToVisibility}}"/>
                        </StackPanel>
                        <Separator Grid.Row="17" Grid.ColumnSpan="2" Style="{StaticResource MySeparatorSummaries}" />

                        <TextBlock Grid.Row="18" Grid.Column="0" Style="{StaticResource MyTextBlockPropertyName}" Text="Surveying"/>
                        <StackPanel Grid.Row="18" Grid.Column="2" Style="{StaticResource MyStackPanel}" >
                            <TextBlock Style="{StaticResource MyTextBlockPropertyValueCosts}" Text="{Binding CalcSurveyingCost, Mode=TwoWay, StringFormat=C2}"
                                       Foreground="{Binding IsError, Converter={StaticResource BoolToBrushText}}"
                                       Visibility="{Binding IsMajorError, Converter={StaticResource BoolToVisibility}}"/>
                        </StackPanel>
                        <Separator Grid.Row="18" Grid.ColumnSpan="2" Style="{StaticResource MySeparatorSummaries}" />

                        <TextBlock Grid.Row="19" Grid.Column="0" Style="{StaticResource MyTextBlockPropertyName}" Text="Construction Inspection"/>
                        <StackPanel Grid.Row="19" Grid.Column="2" Style="{StaticResource MyStackPanel}" >
                            <TextBlock Style="{StaticResource MyTextBlockPropertyValueCosts}" Text="{Binding CalcConstructionInspectionCost, Mode=TwoWay, StringFormat=C2}"
                                       Foreground="{Binding IsError, Converter={StaticResource BoolToBrushText}}"
                                       Visibility="{Binding IsMajorError, Converter={StaticResource BoolToVisibility}}"/>
                        </StackPanel>
                        <Separator Grid.Row="19" Grid.ColumnSpan="2" Style="{StaticResource MySeparatorSummaries}" />
                        
                        <TextBlock Grid.Row="20" Grid.Column="0" Style="{StaticResource MyTextBlockPropertyName}" Text="Contingency"/>
                        <StackPanel Grid.Row="20" Grid.Column="2" Style="{StaticResource MyStackPanel}" >
                            <TextBlock Style="{StaticResource MyTextBlockPropertyValueCosts}" Text="{Binding CalcContingencyCost, Mode=TwoWay, StringFormat=C2}"
                                       Foreground="{Binding IsError, Converter={StaticResource BoolToBrushText}}"
                                       Visibility="{Binding IsMajorError, Converter={StaticResource BoolToVisibility}}" />
                        </StackPanel>
                        <Separator Grid.Row="20" Grid.ColumnSpan="2" Style="{StaticResource MySeparatorSummaries}" />

                        <RadioButton x:Name="radioButtonCapitalCostContingencyEstimate" Grid.Row="21" Grid.Column="0" Margin="50,0,0,0" FontSize="14" GroupName="CapitalCostContingency" Content="Percentage of Capitial Cost"  
                                 IsChecked="{Binding ContingencyOptionsProperty, Mode=TwoWay, Converter={StaticResource RadioButtonCheckedConverter}, ConverterParameter=OptionEstimate}" />

                        <StackPanel Grid.Row="21" Grid.Column="1" Style="{StaticResource MyStackPanel}" >
                            <Controls:NumericUpDown Style="{StaticResource MyNumericUpDownContingencyPercentage}" Minimum="0" Maximum="75" Interval="1"  
                                                    Value="{Binding ContingencyPercentage, Mode=TwoWay}"
                                                    ToolTip="min = 0, max = 75"/>
                            <Label Style="{StaticResource MyLabelContingencyPercentageUnits}" Content="%" />
                        </StackPanel>

                        <RadioButton x:Name="radioButtonCapitalCostContingencyUserSpecified" Grid.Row="22" Grid.Column="0" Margin="50,0,0,0" FontSize="14" GroupName="CapitalCostContingency" Content="User-Specified"  
                                 IsChecked="{Binding ContingencyOptionsProperty, Mode=TwoWay, Converter={StaticResource RadioButtonCheckedConverter}, ConverterParameter=OptionUserSpecified}" />

                        <StackPanel Grid.Row="22" Grid.Column="1" Style="{StaticResource MyStackPanel}" >
                            <Controls:NumericUpDown Style="{StaticResource MyNumericUpDownContingencyCostUserSpecified}" Minimum="0" Maximum="50000000" Interval="100" StringFormat="C2" 
                                                    Value="{Binding ContingencyCostUserSpecified, Mode=TwoWay}"
                                                    ToolTip="min = 0, max = 5,000,000"/>
                            <Label Style="{StaticResource MyLabelContingencyCostUserSpecifiedUnits}" Content="" />
                        </StackPanel>

                        <TextBlock Grid.Row="23" Grid.Column="0" Style="{StaticResource MyTextBlockPropertyName}" Text="Other Items"/>
                        <StackPanel Grid.Row="23" Grid.Column="2" Style="{StaticResource MyStackPanel}" >
                            <TextBlock Style="{StaticResource MyTextBlockPropertyValueCosts}" Text="{Binding CalcOtherCapitalItemsCost, Mode=TwoWay, StringFormat=C2}"
                                       Foreground="{Binding IsError, Converter={StaticResource BoolToBrushText}}"
                                       Visibility="{Binding IsMajorError, Converter={StaticResource BoolToVisibility}}"/>
                        </StackPanel>
                        <Separator Grid.Row="23" Grid.ColumnSpan="2" Style="{StaticResource MySeparatorSummaries}" />

                        <TextBlock Grid.Row="24" Grid.Column="0" Style="{StaticResource MyTextBlockPropertyName}" Text="Total Passive Modules"/>
                        <StackPanel Grid.Row="24" Grid.Column="2" Style="{StaticResource MyStackPanel}" >
                            <TextBlock Style="{StaticResource MyTextBlockPropertyValueCosts}" Text="{Binding CalcCapitalCostPassiveModules, Mode=TwoWay, StringFormat=C2}"
                                       Foreground="{Binding IsError, Converter={StaticResource BoolToBrushText}}"
                                       Visibility="{Binding IsMajorError, Converter={StaticResource BoolToVisibility}}"/>
                        </StackPanel>
                        <Separator Grid.Row="24" Grid.ColumnSpan="2" Style="{StaticResource MySeparatorSummaries}" />

                        <TextBlock Grid.Row="25" Grid.Column="0" Style="{StaticResource MyTextBlockPropertyName}" Text="Total Active Modules"/>
                        <StackPanel Grid.Row="25" Grid.Column="2" Style="{StaticResource MyStackPanel}" >
                            <TextBlock Style="{StaticResource MyTextBlockPropertyValueCosts}" Text="{Binding CalcCapitalCostActiveModules, Mode=TwoWay, StringFormat=C2}"
                                       Foreground="{Binding IsError, Converter={StaticResource BoolToBrushText}}"
                                       Visibility="{Binding IsMajorError, Converter={StaticResource BoolToVisibility}}"/>
                        </StackPanel>
                        <Separator Grid.Row="25" Grid.ColumnSpan="2" Style="{StaticResource MySeparatorSummaries}" />

                        <TextBlock Grid.Row="26" Grid.Column="0" Style="{StaticResource MyTextBlockPropertyName}" Text="Total Passive and Active Modules"/>
                        <StackPanel Grid.Row="26" Grid.Column="2" Style="{StaticResource MyStackPanel}" >
                            <TextBlock Style="{StaticResource MyTextBlockPropertyValueCosts}" Text="{Binding CalcCapitalCostPassiveAndActiveModules, Mode=TwoWay, StringFormat=C2}"
                                       Foreground="{Binding IsError, Converter={StaticResource BoolToBrushText}}"
                                       Visibility="{Binding IsMajorError, Converter={StaticResource BoolToVisibility}}"/>
                        </StackPanel>
                        <Separator Grid.Row="26" Grid.ColumnSpan="2" Style="{StaticResource MySeparatorSummaries}" />

                    </Grid>
                </ScrollViewer>

                <!-- Annual Cost Summary -->
                <Grid Style="{StaticResource MyGridHeader}">
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition ></ColumnDefinition>
                        <ColumnDefinition ></ColumnDefinition>
                        <ColumnDefinition Width=".1*"></ColumnDefinition>
                    </Grid.ColumnDefinitions>

                    <Grid.RowDefinitions>
                        <RowDefinition></RowDefinition>
                    </Grid.RowDefinitions>

                    <StackPanel Grid.Row="0" Grid.Column="0" Orientation="Horizontal">
                        <iconPacks:PackIconModern Kind="CurrencyDollar" Style="{StaticResource MyIconPackModernHeadersCost}" />
                        <TextBlock Grid.Row="0" Grid.Column="0" Style="{StaticResource MyTextBlockHeader}" Text="Annual Cost" />
                    </StackPanel>
                    <TextBlock Grid.Row="0" Grid.Column="1" Style="{StaticResource MyTextBlockHeaderValue}" Text="{Binding CalcAnnualCost, Mode=TwoWay, StringFormat=C2}" 
                               Foreground="{Binding IsError, Converter={StaticResource BoolToBrushText}}"
                               Visibility="{Binding IsMajorError, Converter={StaticResource BoolToVisibility}}" 
                               HorizontalAlignment="Right"
                               ToolTip="Total Annual Cost"/>
                    <Button Grid.Row="0" Grid.Column="2" Style="{StaticResource MyButtonSectionInformation}" ToolTip="About Annual Cost" 
                                Content="{iconPacks:Modern InformationCircle, Width=12, Height=12}"  
                                Command="{Binding ShowMessageDialogCommandAnnualCost}"/>
                    <Separator Grid.Row="0" Grid.ColumnSpan="3" Style="{StaticResource MySeparatorHeader}" Background="{Binding IsError, Converter={StaticResource BoolToBrushSeparater}}" />
                </Grid>

                <ScrollViewer Style="{StaticResource MyScrollViewerForEachSection}" HorizontalScrollBarVisibility="Auto" Height="250">
                    <Grid>
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition></ColumnDefinition>
                            <ColumnDefinition></ColumnDefinition>
                        </Grid.ColumnDefinitions>

                        <Grid.RowDefinitions>
                            <RowDefinition></RowDefinition>
                            <RowDefinition></RowDefinition>
                            <RowDefinition></RowDefinition>
                            <RowDefinition></RowDefinition>
                            <RowDefinition></RowDefinition>
                            <RowDefinition></RowDefinition>
                            <RowDefinition></RowDefinition>
                            <RowDefinition></RowDefinition>
                        </Grid.RowDefinitions>

                        <Grid.Resources>
                            <converters:RadioButtonCheckedConverter x:Key="RadioButtonCheckedConverter" />
                        </Grid.Resources>

                        <TextBlock Grid.Row="0" Grid.Column="0" Style="{StaticResource MyTextBlockPropertyName}" Text="Operation" />
                        <StackPanel Grid.Row="0" Grid.Column="2" Style="{StaticResource MyStackPanel}" >
                            <TextBlock Style="{StaticResource MyTextBlockPropertyValueCosts}" Text="{Binding CalcAnnualCostOperation, Mode=TwoWay, StringFormat=C2}"
                                       Foreground="{Binding IsError, Converter={StaticResource BoolToBrushText}}"
                                       Visibility="{Binding IsMajorError, Converter={StaticResource BoolToVisibility}}"/>
                        </StackPanel>
                        <Separator Grid.Row="0" Grid.ColumnSpan="2" Style="{StaticResource MySeparatorSummaries}" />

                        <RadioButton x:Name="radioButtonAnnualCostOperationEstimated" Grid.Row="1" Grid.Column="0" Margin="50,0,0,0" FontSize="14" GroupName="AnnualCostOperation" Content="Percentage of Capital Cost"  
                                 IsChecked="{Binding AnnualCostOperationOptionsProperty, Mode=TwoWay, Converter={StaticResource RadioButtonCheckedConverter}, ConverterParameter=OptionEstimated}" />

                        <StackPanel Grid.Row="1" Grid.Column="1" Style="{StaticResource MyStackPanel}" >
                            <Controls:NumericUpDown Style="{StaticResource MyNumericUpDownAnnualCostOperationPercentage}" Minimum="0" Maximum="50" Interval="0.5"  
                                                    Value="{Binding AnnualCostOperationPercentage, Mode=TwoWay}"
                                                    ToolTip="min = 0, max = 50"/>
                            <Label Style="{StaticResource MyLabelAnnualCostOperationPercentageUnits}" Content="%" />
                        </StackPanel>

                        <RadioButton x:Name="radioButtonAnnualCostOperationUserSpecified" Grid.Row="2" Grid.Column="0" Margin="50,0,0,0" FontSize="14" GroupName="AnnualCostOperation" Content="User-Specified"  
                                 IsChecked="{Binding AnnualCostOperationOptionsProperty, Mode=TwoWay, Converter={StaticResource RadioButtonCheckedConverter}, ConverterParameter=OptionUserSpecified}" />

                        <StackPanel Grid.Row="2" Grid.Column="1" Style="{StaticResource MyStackPanel}" >
                            <Controls:NumericUpDown Style="{StaticResource MyNumericUpDownAnnualCostOperationUserSpecified}" Minimum="0" Maximum="1000000" Interval="1000" StringFormat="C2" 
                                                    Value="{Binding AnnualCostOperationUserSpecified, Mode=TwoWay}"
                                                    ToolTip="min = 0, max = 1,000,000"/>
                            <Label Style="{StaticResource MyLabelAnnualCostOperationUserSpecifiedUnits}" Content="" />
                        </StackPanel>

                        <TextBlock Grid.Row="3" Grid.Column="0" Style="{StaticResource MyTextBlockPropertyName}" Text="Land Lease" />
                        <StackPanel Grid.Row="3" Grid.Column="1" Style="{StaticResource MyStackPanel}" >
                            <TextBlock Style="{StaticResource MyTextBlockPropertyValueCosts}" Text="{Binding CalcAnnualCostLandLeaseCost, Mode=TwoWay, StringFormat=C2}"
                                       Foreground="{Binding IsError, Converter={StaticResource BoolToBrushText}}"
                                       Visibility="{Binding IsMajorError, Converter={StaticResource BoolToVisibility}}"/>
                        </StackPanel>
                        <Separator Grid.Row="3" Grid.ColumnSpan="2" Style="{StaticResource MySeparatorSummaries}" />

                        <TextBlock Grid.Row="4" Grid.Column="0" Style="{StaticResource MyTextBlockPropertyName}" Text="Maintenance" />
                        <StackPanel Grid.Row="4" Grid.Column="2" Style="{StaticResource MyStackPanel}" >
                            <TextBlock Style="{StaticResource MyTextBlockPropertyValueCosts}" Text="{Binding CalcAnnualCostMaintenance, Mode=TwoWay, StringFormat=C2}"
                                       Foreground="{Binding IsError, Converter={StaticResource BoolToBrushText}}"
                                       Visibility="{Binding IsMajorError, Converter={StaticResource BoolToVisibility}}"/>
                        </StackPanel>
                        <Separator Grid.Row="4" Grid.ColumnSpan="2" Style="{StaticResource MySeparatorSummaries}" />

                        <TextBlock Grid.Row="5" Grid.Column="0" Style="{StaticResource MyTextBlockPropertyName}" Text="Repairs" />
                        <StackPanel Grid.Row="5" Grid.Column="2" Style="{StaticResource MyStackPanel}" >
                            <TextBlock Style="{StaticResource MyTextBlockPropertyValueCosts}" Text="{Binding CalcAnnualCostRepairs, Mode=TwoWay, StringFormat=C2}"
                                       Foreground="{Binding IsError, Converter={StaticResource BoolToBrushText}}"
                                       Visibility="{Binding IsMajorError, Converter={StaticResource BoolToVisibility}}"/>
                        </StackPanel>
                        <Separator Grid.Row="5" Grid.ColumnSpan="2" Style="{StaticResource MySeparatorSummaries}" />

                        <RadioButton x:Name="radioButtonAnnualCostRepairsEstimated" Grid.Row="6" Grid.Column="0" Margin="50,0,0,0" FontSize="14" GroupName="AnnualCostRepairs" Content="Percentage of Capital Cost"  
                                 IsChecked="{Binding AnnualCostRepairsOptionsProperty, Mode=TwoWay, Converter={StaticResource RadioButtonCheckedConverter}, ConverterParameter=OptionEstimated}" />

                        <StackPanel Grid.Row="6" Grid.Column="1" Style="{StaticResource MyStackPanel}" >
                            <Controls:NumericUpDown Style="{StaticResource MyNumericUpDownAnnualCostRepairsPercentage}" Minimum="0" Maximum="50" Interval="0.5"  
                                                    Value="{Binding AnnualCostRepairsPercentage, Mode=TwoWay}"
                                                    ToolTip="min = 0, max = 50"/>
                            <Label Style="{StaticResource MyLabelAnnualCostRepairsPercentageUnits}" Content="%" />
                        </StackPanel>

                        <RadioButton x:Name="radioButtonAnnualCostRepairsUserSpecified" Grid.Row="7" Grid.Column="0" Margin="50,0,0,0" FontSize="14" GroupName="AnnualCostRepairs" Content="User-Specified"  
                                 IsChecked="{Binding AnnualCostRepairsOptionsProperty, Mode=TwoWay, Converter={StaticResource RadioButtonCheckedConverter}, ConverterParameter=OptionUserSpecified}" />

                        <StackPanel Grid.Row="7" Grid.Column="1" Style="{StaticResource MyStackPanel}" >
                            <Controls:NumericUpDown Style="{StaticResource MyNumericUpDownAnnualCostRepairsUserSpecified}" Minimum="0" Maximum="1000000" Interval="1000" StringFormat="C2" 
                                                    Value="{Binding AnnualCostRepairsUserSpecified, Mode=TwoWay}"
                                                    ToolTip="min = 0, max = 1,000,000"/>
                            <Label Style="{StaticResource MyLabelAnnualCostRepairsUserSpecifiedUnits}" Content="" />
                        </StackPanel>
                    </Grid>
                </ScrollViewer>

                <!-- Recapitalization Cost Summary -->
                <Grid Style="{StaticResource MyGridHeader}">
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition ></ColumnDefinition>
                        <ColumnDefinition ></ColumnDefinition>
                        <ColumnDefinition Width=".1*"></ColumnDefinition>
                    </Grid.ColumnDefinitions>

                    <Grid.RowDefinitions>
                        <RowDefinition></RowDefinition>
                    </Grid.RowDefinitions>

                    <StackPanel Grid.Row="0" Grid.Column="0" Orientation="Horizontal">
                        <iconPacks:PackIconModern Kind="CurrencyDollar" Style="{StaticResource MyIconPackModernHeadersCost}" />
                        <TextBlock Grid.Row="0" Grid.Column="0" Style="{StaticResource MyTextBlockHeader}" Text="Net Present Value" ToolTip="Net Present Value of Replacement and Annual Costs" />
                    </StackPanel>
                    <TextBlock Grid.Row="0" Grid.Column="1" Style="{StaticResource MyTextBlockHeaderValue}" 
                               Text="{Binding CalcRecapitalizationCostTotal, Mode=TwoWay, StringFormat=C2}" 
                               Foreground="{Binding IsError, Converter={StaticResource BoolToBrushText}}"
                               Visibility="{Binding IsMajorError, Converter={StaticResource BoolToVisibility}}" 
                               HorizontalAlignment="Right"
                               ToolTip="Total Net Present Value of Replacement and Annual Costs"/>
                    <Button Grid.Row="0" Grid.Column="2" Style="{StaticResource MyButtonSectionInformation}" ToolTip="About Net Present Value of Replacement and Annual Costs" 
                                Content="{iconPacks:Modern InformationCircle, Width=12, Height=12}"  
                                Command="{Binding ShowMessageDialogCommandRecapitalizationCost}"/>
                    <Separator Grid.Row="0" Grid.ColumnSpan="3" Style="{StaticResource MySeparatorHeader}" 
                               Background="{Binding IsError, Converter={StaticResource BoolToBrushSeparater}}" />
                </Grid>

                <ScrollViewer Style="{StaticResource MyScrollViewerForEachSection}"  >
                    <Grid>
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition></ColumnDefinition>
                            <ColumnDefinition></ColumnDefinition>
                        </Grid.ColumnDefinitions>

                        <Grid.RowDefinitions>
                            <RowDefinition></RowDefinition>
                            <RowDefinition></RowDefinition>
                            <RowDefinition></RowDefinition>
                            <RowDefinition></RowDefinition>
                            <RowDefinition></RowDefinition>
                            <RowDefinition></RowDefinition>
                            <RowDefinition></RowDefinition>

                        </Grid.RowDefinitions>

                        <Grid.Resources>
                            <converters:RadioButtonCheckedConverter x:Key="RadioButtonCheckedConverter" />
                        </Grid.Resources>

                        <TextBlock Grid.Row="0" Grid.Column="0" Style="{StaticResource MyTextBlockPropertyName}" Text="Term of Analysis" />
                        <StackPanel Grid.Row="0" Grid.Column="1" Style="{StaticResource MyStackPanel}">
                            <TextBlock Style="{StaticResource MyTextBlockPropertyValue}" Text="{Binding CalcRecapitalizationCostCalculationPeriod, Mode=Twoway, StringFormat=F2}"/>
                            <TextBlock Style="{StaticResource MyTextBlockPropertyUnits}" Text="years" />
                        </StackPanel>
                        <Separator Grid.Row="0" Grid.ColumnSpan="2" Style="{StaticResource MySeparatorSummaries}" />

                        <TextBlock Grid.Row="1" Grid.Column="0" Style="{StaticResource MyTextBlockPropertyName}" Text="Inflation Rate" />
                        <StackPanel Grid.Row="1" Grid.Column="1" Style="{StaticResource MyStackPanel}">
                            <TextBlock Style="{StaticResource MyTextBlockPropertyValue}" Text="{Binding CalcRecapitalizationCostInflationRate, Mode=Twoway, StringFormat=F2}"/>
                            <TextBlock Style="{StaticResource MyTextBlockPropertyUnits}" Text="%" />
                        </StackPanel>
                        <Separator Grid.Row="1" Grid.ColumnSpan="2" Style="{StaticResource MySeparatorSummaries}" />

                        <TextBlock Grid.Row="2" Grid.Column="0" Style="{StaticResource MyTextBlockPropertyName}" Text="Rate of Return" />
                        <StackPanel Grid.Row="2" Grid.Column="1" Style="{StaticResource MyStackPanel}">
                            <TextBlock Style="{StaticResource MyTextBlockPropertyValue}" Text="{Binding CalcRecapitalizationCostNetRateOfReturn, Mode=Twoway, StringFormat=F2}"/>
                            <TextBlock Style="{StaticResource MyTextBlockPropertyUnits}" Text="%" />
                        </StackPanel>
                        <Separator Grid.Row="2" Grid.ColumnSpan="2" Style="{StaticResource MySeparatorSummaries}" />

                        <TextBlock Grid.Row="3" Grid.Column="0" Style="{StaticResource MyTextBlockPropertyName}" Text=""></TextBlock>
                        <StackPanel Grid.Row="3" Grid.Column="1" Style="{StaticResource MyStackPanel}" >
                            <TextBlock Style="{StaticResource MyTextBlockPropertyValueCosts}" 
                                       Text="{Binding CalcUpdateRecapMaterialCostDefault, Mode=TwoWay, StringFormat=C2}"
                                       Visibility="Hidden"/>
                        </StackPanel>

                        <TextBlock Grid.Row="3" Grid.Column="0" Style="{StaticResource MyTextBlockPropertyName}" Text=""></TextBlock>
                        <StackPanel Grid.Row="3" Grid.Column="1" Style="{StaticResource MyStackPanel}" >
                            <TextBlock Style="{StaticResource MyTextBlockPropertyValueCosts}" 
                                       Text="{Binding CalcUpdateRecapMaterialCostTotal, Mode=TwoWay, StringFormat=C2}"
                                       Visibility="Hidden"/>
                        </StackPanel>

                        <DataGrid Grid.Row="4" Grid.ColumnSpan="2" ItemsSource="{Binding RecapMaterials, Mode=TwoWay}" 
                                  AutoGenerateColumns="False" CanUserAddRows="True" CanUserDeleteRows="False" SelectionUnit="Cell"
                                  Foreground="{Binding IsError, Converter={StaticResource BoolToBrushText}}"
                                  Visibility="{Binding IsMajorError, Converter={StaticResource BoolToVisibility}}" >
                            <DataGrid.Columns>
                                <DataGridCheckBoxColumn 
                                        ElementStyle="{DynamicResource MetroDataGridCheckBox}"
                                        EditingElementStyle="{DynamicResource MetroDataGridCheckBox}"
                                        Header="Select"
                                        Binding="{Binding IsSelected, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"/>
                                <DataGridTextColumn Header="Name" Binding="{Binding Name}" />
                                <Controls:DataGridNumericUpDownColumn Header="Life Cycle (yrs)" 
                                                      Binding="{Binding LifeCycle, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"
                                                      Minimum="1" 
                                                      Maximum="100">
                                    <Controls:DataGridNumericUpDownColumn.HeaderTemplate>
                                        <DataTemplate>
                                            <TextBlock Text="LIFE CYCLE (YRS)" ToolTip="min = 1, max = 50" />
                                        </DataTemplate>
                                    </Controls:DataGridNumericUpDownColumn.HeaderTemplate>
                                </Controls:DataGridNumericUpDownColumn>
                                <Controls:DataGridNumericUpDownColumn Header="Replacement %"
                                                      Binding="{Binding PercentReplacement, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"
                                                      Minimum="0" 
                                                      Maximum="100">
                                    <Controls:DataGridNumericUpDownColumn.HeaderTemplate>
                                        <DataTemplate>
                                            <TextBlock Text="REPLACEMENT %" ToolTip="min = 0, max = 100" />
                                        </DataTemplate>
                                    </Controls:DataGridNumericUpDownColumn.HeaderTemplate>
                                </Controls:DataGridNumericUpDownColumn>
                                <Controls:DataGridNumericUpDownColumn Header="Default Cost"
                                                      Binding="{Binding MaterialCostDefault}"
                                                      StringFormat="C" 
                                                      IsReadOnly="True"
                                                      Foreground="Gray"/>
                                <Controls:DataGridNumericUpDownColumn Header="Custom Cost"
                                                      Binding="{Binding MaterialCostCustom, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"
                                                      StringFormat="C"
                                                      Minimum="0" >
                                    <Controls:DataGridNumericUpDownColumn.HeaderTemplate>
                                        <DataTemplate>
                                            <TextBlock Text="CUSTOM COST" ToolTip="min = 0, max = " />
                                        </DataTemplate>
                                    </Controls:DataGridNumericUpDownColumn.HeaderTemplate>
                                </Controls:DataGridNumericUpDownColumn>
                                <DataGridCheckBoxColumn 
                                        ElementStyle="{DynamicResource MetroDataGridCheckBox}"
                                        EditingElementStyle="{DynamicResource MetroDataGridCheckBox}"
                                        Header="Use Custom"
                                        Binding="{Binding UseCustomCost, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"/>
                                <Controls:DataGridNumericUpDownColumn Header="Total Cost"
                                                      Binding="{Binding TotalCost}"
                                                      StringFormat="C"
                                                      IsReadOnly="True"/>
                            </DataGrid.Columns>
                        </DataGrid>

                        <Separator Grid.Row="4" Grid.ColumnSpan="2" Style="{StaticResource MySeparatorSummaries}" />

                    </Grid>

                </ScrollViewer>

            </StackPanel>
        </ScrollViewer>

    </Grid>

</Controls:MetroWindow>
